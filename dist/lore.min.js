(function(){function s(l,e,n){function t(m,r){if(!e[m]){if(!l[m]){var i="function"==typeof require&&require;if(!r&&i)return i(m,!0);if(o)return o(m,!0);var c=new Error("Cannot find module '"+m+"'");throw c.code="MODULE_NOT_FOUND",c}var a=e[m]={exports:{}};l[m][0].call(a.exports,function(e){var o=l[m][1][e];return t(o||e)},a,a.exports,s,l,e,n)}return e[m].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)t(n[r]);return t}return s})()({1:[function(e,t){"use strict";function o(e){let t=Object.keys(e).reduce((t,o)=>(t[e[o]]=o,t),{});return Object.freeze(Object.keys(e).reduce((t,o)=>(t[o]=e[o],t),e=>t[e]))}var n=!!("undefined"!=typeof window&&window.document&&window.document.createElement),r=e("./src/Lore");r.Mouse=o({Left:0,Middle:1,Right:2}),r.Keyboard=o({Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Esc:27}),r.init=function(e,t){this.opts=r.Utils.extend(!0,r.defaults,t);var o=r.Core.Color.fromHex(this.opts.clearColor),n=new r.Core.Renderer(e,{clearColor:o,verbose:!0,fps:document.getElementById("fps"),center:new r.Math.Vector3f(125,125,125),antialiasing:this.opts.antialiasing,alphaBlending:this.opts.alphaBlending,preserveDrawingBuffer:this.opts.preserveDrawingBuffer});return n.controls.limitRotationToHorizon(this.opts.limitRotationToHorizon),n.render=function(e,t){for(var o in t)t[o].draw(n)},n},r.getGrakaInfo=function(e){let t=document.getElementById(e),o=t.getContext("webgl")||t.getContext("experimental-webgl"),n={renderer:"",vendor:""},r=o.getExtension("WEBGL_debug_renderer_info");return null!=r&&(n.renderer=o.getParameter(r.UNMASKED_RENDERER_WEBGL),n.vendor=o.getParameter(r.UNMASKED_VENDOR_WEBGL)),n},r.supportsHighQuality=function(e){r.getGrakaInfo(e);return!1},r.defaults={clearColor:"#121212",limitRotationToHorizon:!1,antialiasing:!1,preserveDrawingBuffer:!1},n&&(window.Lore=r),t.exports=r},{"./src/Lore":36}],2:[function(e,t){"use strict";var o=Math.round;const n=e("../Core/Node"),r=e("../Math/ProjectionMatrix"),i=e("../Math/Matrix4f"),s=e("../Math/Vector3f");t.exports=class extends n{constructor(){super(),this.type="Lore.CameraBase",this.renderer=null,this.isProjectionMatrixStale=!1,this.isViewMatrixStale=!1,this.projectionMatrix=new r,this.viewMatrix=new i,this.near=0,this.far=1e3,this._eventListeners={}}init(e,t){return this.gl=e,this.program=t,this}setLookAt(e){return this.rotation.lookAt(this.position,e,s.up()),this}updateViewport(){return this}updateProjectionMatrix(){return this}updateViewMatrix(){this.update();let e=this.modelMatrix.clone();return e.invert(),this.viewMatrix=e,this.isViewMatrixStale=!0,this}getProjectionMatrix(){return this.projectionMatrix.entries}getViewMatrix(){return this.viewMatrix.entries}getFrustum(){return null}sceneToScreen(e,t){let n=e.clone(),r=t.canvas;i.projectVector(n,this);let s=o((n.components[0]+1)*r.width/2)/t.devicePixelRatio,a=o((-n.components[1]+1)*r.height/2)/t.devicePixelRatio;return[s,a]}addEventListener(e,t){this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t)}removeEventListener(e,t){if(this._eventListeners.hasOwnProperty(e)){let o=this._eventListeners[e].indexOf(t);-1<o&&this._eventListeners[e].splice(o,1)}}raiseEvent(e,t={}){if(this._eventListeners[e])for(let o=0;o<this._eventListeners[e].length;o++)this._eventListeners[e][o](t)}}},{"../Core/Node":16,"../Math/Matrix4f":38,"../Math/ProjectionMatrix":39,"../Math/Vector3f":45}],3:[function(e,t){"use strict";const o=e("./CameraBase"),n=e("../Math/Vector3f"),r=e("../Math/Matrix4f");t.exports=class extends o{constructor(e,t,o,n,r=.1,i=2500){super(),this.type="Lore.OrthographicCamera",this.zoom=1,this.left=e,this.right=t,this.top=o,this.bottom=n,this.near=r,this.far=i,this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,n=(this.top+this.bottom)/2;return this.projectionMatrix.setOrthographic(o-e,o+e,n+t,n-t,this.near,this.far),this.isProjectionMatrixStale=!0,this.raiseEvent("projectionmatrixupdated",{source:this}),this}updateViewport(e,t){return this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2,this.raiseEvent("viewportupdated",{source:this}),this}getFrustum(){let e=(this.near+this.far)/(this.near-this.far),t=new n(-1,-1,e),o=new n(1,1,e);return r.unprojectVector(t,this),r.unprojectVector(o,this),[t,o]}}},{"../Math/Matrix4f":38,"../Math/Vector3f":45,"./CameraBase":2}],4:[function(e,t){"use strict";const o=e("./CameraBase");t.exports=class extends o{constructor(e,t,o=.1,n=2500){super(),this.type="Lore.PerspectiveCamera",this.zoom=1,this.fov=e,this.aspect=t,this.near=o,this.far=n,this.updateProjectionMatrix()}updateProjectionMatrix(){return this.projectionMatrix.setPerspective(this.fov,this.aspect,this.near,this.far),this.isProjectionMatrixStale=!0,this}updateViewport(e,t){return this.aspect=e/t,this}}},{"./CameraBase":2}],5:[function(e,t){"use strict";const o=e("./CameraBase"),n=e("./OrthographicCamera"),r=e("./PerspectiveCamera");t.exports={CameraBase:o,OrthographicCamera:n,PerspectiveCamera:r}},{"./CameraBase":2,"./OrthographicCamera":3,"./PerspectiveCamera":4}],6:[function(e,t){"use strict";var o=Math.pow;const n=e("../Math/Vector3f");t.exports=class{constructor(e,t=new n(0,0,0),r=!1){this.renderer=e,this.camera=e.camera,this.canvas=e.canvas,this.lowFps=15,this.highFps=30,this._eventListeners={},this.renderer.setMaxFps(this.lowFps),this.touchMode="drag",this.lookAt=t,this.mouse={previousPosition:{x:null,y:null},delta:{x:0,y:0},state:{left:!1,middle:!1,right:!1},normalizedPosition:{x:0,y:0},moved:!1,touches:0,pointerCache:[],pinchDiff:0},this.keyboard={alt:!1,ctrl:!1,shift:!1},this.VR={};let a=this;this.canvas.style.touchAction="none",this.canvas.addEventListener("pointermove",function(t){for(var e=0;e<a.mouse.pointerCache.length;e++)if(t.pointerId==a.mouse.pointerCache[e].pointerId){a.mouse.pointerCache[e]=t;break}let n=a.getPointerLocation();if(2===a.mouse.pointerCache.length){var r=o(a.mouse.pointerCache[1].clientX-a.mouse.pointerCache[0].clientX,2)+o(a.mouse.pointerCache[1].clientY-a.mouse.pointerCache[0].clientY,2);0<a.mouse.pinchDiff&&(r>a.mouse.pinchDiff?a.raiseEvent("touch",{e:{x:-1,y:-1,speed:.5},source:"pinch"}):r<a.mouse.pinchDiff&&a.raiseEvent("touch",{e:{x:1,y:1,speed:.5},source:"pinch"})),a.mouse.pinchDiff=r}else null!==a.mouse.previousPosition.x&&3===a.mouse.pointerCache.length?(a.mouse.delta.x=n[0]-a.mouse.previousPosition.x,a.mouse.delta.y=n[1]-a.mouse.previousPosition.y,a.mouse.moved=!0,a.raiseEvent("mousedrag",{e:a.mouse.delta,source:"right"})):null!==a.mouse.previousPosition.x&&(a.mouse.state.left||a.mouse.state.middle||a.mouse.state.right)&&(a.mouse.delta.x=n[0]-a.mouse.previousPosition.x,a.mouse.delta.y=n[1]-a.mouse.previousPosition.y,a.mouse.moved=!0,a.mouse.state.left?a.raiseEvent("mousedrag",{e:a.mouse.delta,source:"left"}):a.mouse.state.middle?a.raiseEvent("mousedrag",{e:a.mouse.delta,source:"middle"}):a.mouse.state.right&&a.raiseEvent("mousedrag",{e:a.mouse.delta,source:"right"}));let l=a.canvas.getBoundingClientRect(),c=a.renderer.devicePixelRatio;a.mouse.normalizedPosition.x=2*((t.clientX-l.left*c)/a.canvas.width*c)-1,a.mouse.normalizedPosition.y=2*-((t.clientY-l.top*c)/a.canvas.height*c)+1,a.raiseEvent("mousemove",{e:a}),a.mouse.previousPosition.x=n[0],a.mouse.previousPosition.y=n[1]});let l="mousewheel";-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&(l="DOMMouseScroll"),this.canvas.addEventListener(l,function(t){if(!a.isInIframe()||t.ctrlKey){t.preventDefault();let e="wheelDelta"in t?t.wheelDelta:-40*t.detail;a.raiseEvent("mousewheel",{e:e})}}),this.canvas.addEventListener("keydown",function(t){16==t.which?a.keyboard.shift=!0:17==t.which?a.keyboard.ctrl=!0:18==t.which&&(a.keyboard.alt=!0),a.raiseEvent("keydown",{e:t.which})}),this.canvas.addEventListener("keyup",function(t){16==t.which?a.keyboard.shift=!1:17==t.which?a.keyboard.ctrl=!1:18==t.which&&(a.keyboard.alt=!1),a.raiseEvent("keyup",{e:t.which})}),this.canvas.addEventListener("pointerdown",function(t){let e=t.button,o="left";a.mouse.pointerCache.push(t),0==e?a.mouse.state.left=!0:1==e?(a.mouse.state.middle=!0,o="middle"):2==e&&(a.mouse.state.right=!0,o="right"),a.renderer.setMaxFps(a.highFps),a.mouse.moved=!1,a.raiseEvent("mousedown",{e:a,source:o})}),this.canvas.addEventListener("click",function(t){let e=t.button;a.mouse.moved||a.raiseEvent("click",{e:a,source:"left"})}),this.canvas.addEventListener("dblclick",function(t){let e=t.button;a.raiseEvent("dblclick",{e:a,source:"left"})});let c=function(t){let e=t.button,o="left";a.removeEvent(t),a.mouse.pinchDiff=0,0==e?a.mouse.state.left=!1:1==e?(a.mouse.state.middle=!1,o="middle"):2==e&&(a.mouse.state.right=!1,o="right"),a.mouse.previousPosition.x=null,a.mouse.previousPosition.y=null,a.mouse.state.left=!1,a.mouse.state.middle=!1,a.mouse.state.right=!1,a.renderer.setMaxFps(a.lowFps),a.raiseEvent("mouseup",{e:a,source:o})};this.canvas.addEventListener("pointerup",function(t){c(t)}),this.canvas.addEventListener("pointercancel",function(t){c(t)}),this.canvas.addEventListener("pointerleave",function(t){c(t)})}addEventListener(e,t){this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t)}removeEventListener(e,t){if(this._eventListeners.hasOwnProperty(e)){let o=this._eventListeners[e].indexOf(t);-1<o&&this._eventListeners[e].splice(o,1)}}raiseEvent(e,t={}){if(this._eventListeners[e])for(let o=0;o<this._eventListeners[e].length;o++)this._eventListeners[e][o](t)}getLookAt(){return this.lookAt}setLookAt(e){return this.lookAt=e.clone(),this.update(),this}update(t=null,e=null){return this}isInIframe(){try{return window.self!==window.top}catch(t){return!0}}removeEvent(t){for(var e=0;e<this.mouse.pointerCache.length;e++)if(this.mouse.pointerCache[e].pointerId==t.pointerId){this.mouse.pointerCache.splice(e,1);break}}getPointerLocation(){let e=0,t=0,o=this.mouse.pointerCache.length;if(0===o)return[null,null];for(var n=0;n<o;n++)e+=this.mouse.pointerCache[n].pageX,t+=this.mouse.pointerCache[n].pageY;return[e,t]}}},{"../Math/Vector3f":45}],7:[function(e,t){"use strict";const o=e("../Controls/ControlsBase"),n=e("../Math/Vector3f");t.exports=class extends o{constructor(e,t){super(e),this.up=n.up(),this.renderer=e,this.camera=e.camera,this.canvas=e.canvas,this.camera.position=new n(t,t,t),this.camera.updateProjectionMatrix(),this.camera.updateViewMatrix(),this.rotationLocked=!1;let o=this;this.addEventListener("mousedrag",function(t){o.update(t.e,t.source)}),this.update({x:0,y:0},"left")}update(t,e){let o=this.camera.position.clone().subtract(this.lookAt);return this.camera.position.copyFrom(this.lookAt).add(o),this.camera.setLookAt(this.lookAt),this.camera.updateViewMatrix(),this.raiseEvent("updated"),this}}},{"../Controls/ControlsBase":6,"../Math/Vector3f":45}],8:[function(e,t){"use strict";var o=Math.max,n=Math.PI;const r=e("../Controls/ControlsBase"),i=e("../Math/Vector3f"),s=e("../Math/SphericalCoords");t.exports=class extends r{constructor(e,t,o=new i(0,0,0)){super(e,o),this.up=i.up(),this.radius=t,this.yRotationLimit=n,this._dPhi=0,this._dTheta=0,this._dPan=new i(0,0,0),this.spherical=new s,this.scale=.95,this.camera.position=new i(t,t,t),this.camera.updateProjectionMatrix(),this.camera.updateViewMatrix(),this.rotationLocked=!1;let r=this;this.addEventListener("mousedrag",function(t){r.update(t.e,t.source)}),this.addEventListener("touch",function(t){r.update(t.e,t.source)}),this.addEventListener("mousewheel",function(t){r.update({x:0,y:-t.e},"wheel")}),this.update({x:0,y:0},"left")}limitRotationToHorizon(e){return this.yRotationLimit=e?.5*n:n,this}setRadius(e){return this.radius=e,this.camera.position=new i(0,0,e),this.camera.updateProjectionMatrix(),this.camera.updateViewMatrix(),this.update(),this}update(t=null,e=null){if("left"==e&&!this.rotationLocked)this._dTheta=-2*n*t.x/(this.canvas.clientWidth*this.camera.zoom),this._dPhi=-2*n*t.y/(this.canvas.clientHeight*this.camera.zoom);else if("right"==e||"left"==e&&this.rotationLocked){let e=t.x*(this.camera.right-this.camera.left)/this.camera.zoom/this.canvas.clientWidth,o=t.y*(this.camera.top-this.camera.bottom)/this.camera.zoom/this.canvas.clientHeight,n=this.camera.getUpVector().components,i=this.camera.getRightVector().components;this._dPan.components[0]=i[0]*-e+n[0]*o,this._dPan.components[1]=i[1]*-e+n[1]*o,this._dPan.components[2]=i[2]*-e+n[2]*o}else("middle"==e||"wheel"==e||"pinch"==e)&&(0<t.y?(this.camera.zoom=o(0,this.camera.zoom*this.scale),this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom)):0>t.y&&(this.camera.zoom=o(0,this.camera.zoom/this.scale),this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom)));let r=this.camera.position.clone().subtract(this.lookAt);return this.spherical.setFromVector(r),this.spherical.components[1]+=this._dPhi,this.spherical.components[2]+=this._dTheta,this.spherical.limit(0,this.yRotationLimit,-Infinity,1/0),this.spherical.secure(),this.lookAt.add(this._dPan),r.setFromSphericalCoords(this.spherical),this.camera.position.copyFrom(this.lookAt).add(r),this.camera.setLookAt(this.lookAt),this.camera.updateViewMatrix(),this._dPhi=0,this._dTheta=0,this._dPan.set(0,0,0),this.raiseEvent("updated"),this}setView(e,t){let o=this.camera.position.clone().subtract(this.lookAt);return this.spherical.setFromVector(o),this.spherical.components[1]=e,this.spherical.components[2]=t,this.spherical.secure(),o.setFromSphericalCoords(this.spherical),this.camera.position.copyFrom(this.lookAt).add(o),this.camera.setLookAt(this.lookAt),this.camera.updateViewMatrix(),this.raiseEvent("updated"),this}zoomIn(){return this.camera.zoom=o(0,this.camera.zoom/this.scale),this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom),this.raiseEvent("updated"),this}zoomOut(){return this.camera.zoom=o(0,this.camera.zoom*this.scale),this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom),this.raiseEvent("updated"),this}setZoom(e){return this.camera.zoom=e,this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom),this.update(),this}getZoom(){return this.camera.zoom}setViewByName(e){return"left"===e?this.setLeftView():"right"===e?this.setRightView():"top"===e?this.setTopView():"bottom"===e?this.setBottomView():"back"===e?this.setBackView():"front"===e?this.setFrontView():this.setFreeView(),this}setTopView(){return this.setView(0,2*n),this.rotationLocked=!0,this}setBottomView(){return this.setView(0,0),this.rotationLocked=!0,this}setRightView(){return this.setView(.5*n,.5*n),this.rotationLocked=!0,this}setLeftView(){return this.setView(.5*n,-.5*n),this.rotationLocked=!0,this}setFrontView(){return this.setView(.5*n,2*n),this.rotationLocked=!0,this}setBackView(){return this.setView(.5*n,Math.PI),this.rotationLocked=!0,this}setFreeView(){return this.setView(.25*n,.25*n),this.rotationLocked=!1,this}}},{"../Controls/ControlsBase":6,"../Math/SphericalCoords":43,"../Math/Vector3f":45}],9:[function(e,t){"use strict";const o=e("./ControlsBase"),n=e("./FirstPersonControls"),r=e("./OrbitalControls");t.exports={ControlsBase:o,FirstPersonControls:n,OrbitalControls:r}},{"./ControlsBase":6,"./FirstPersonControls":7,"./OrbitalControls":8}],10:[function(e,t){"use strict";e("../Math/Vector3f");t.exports=class{constructor(e,t,o){this.type="Lore.Attribute",this.data=e,this.attributeLength=t||3,this.name=o,this.size=this.data.length/this.attributeLength,this.buffer=null,this.attributeLocation,this.bufferType=null,this.drawMode=null,this.stale=!1}setFromVector(e,t){this.data.set(t.components,e*this.attributeLength,t.components.length)}setFromVectorArray(e){if(this.attributeLength!==e[0].components.length)throw"The attribute has a length of "+this.attributeLength+". But the vectors have "+e[0].components.length+" components.";for(let t=0;t<e.length;t++)this.data.set(e[t].components,t*this.attributeLength,e[t].components.length)}getX(e){return this.data[e*this.attributeLength]}setX(e){this.data[e*this.attributeLength]}getY(e){return this.data[e*this.attributeLength+1]}setY(e){this.data[e*this.attributeLength+1]}getZ(e){return this.data[e*this.attributeLength+2]}setZ(e){this.data[e*this.attributeLength+2]}getW(e){return this.data[e*this.attributeLength+3]}setW(e){this.data[e*this.attributeLength+3]}getGlType(e){return e.FLOAT}update(e){e.bindBuffer(this.bufferType,this.buffer),e.bufferData(this.bufferType,this.data,this.drawMode),this.stale=!1}createBuffer(e,t,o,n){this.buffer=e.createBuffer(),this.bufferType=o||e.ARRAY_BUFFER,this.drawMode=n||e.STATIC_DRAW,e.bindBuffer(this.bufferType,this.buffer),e.bufferData(this.bufferType,this.data,this.drawMode),this.buffer.itemSize=this.attributeLength,this.buffer.numItems=this.size,this.attributeLocation=e.getAttribLocation(t,this.name),e.bindBuffer(this.bufferType,null)}bind(e){e.bindBuffer(this.bufferType,this.buffer),0<=this.attributeLocation&&(e.vertexAttribPointer(this.attributeLocation,this.attributeLength,this.getGlType(e),e.FALSE,0,0),e.enableVertexAttribArray(this.attributeLocation))}}},{"../Math/Vector3f":45}],11:[function(e,t){"use strict";var o=Math.floor,n=Math.round;class i{constructor(e,t,o,n=1){1===arguments.length?this.components=new Float32Array(e):(this.components=new Float32Array(4),this.components[0]=e||0,this.components[1]=t||0,this.components[2]=o||0,this.components[3]=n||1)}set(e,t,o,n){return this.components[0]=e,this.components[1]=t,this.components[2]=o,4==arguments.length&&(this.components[3]=n),this}getR(){return this.components[0]}getG(){return this.components[1]}getB(){return this.components[2]}getA(){return this.components[3]}toFloat(){return i.rgbToFloat(255*this.getR(),255*this.getG(),255*this.getB())}static fromHex(e){let t=i.hexToRgb(e);return new i(t[0]/255,t[1]/255,t[2]/255,1)}static hexToRgb(e){let t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,o,n){return t+t+o+o+n+n});let o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),n=parseInt(o[1],16),r=parseInt(o[2],16),i=parseInt(o[3],16);return[n,r,i]}static hueToRgb(e,o,n){if(0>n)n+=1;else if(1<n)n-=1;else{if(.1667>n)return e+6*(o-e)*n;if(.5>n)return o;if(.6667>n)return e+6*((o-e)*(.6667-n))}return e}static hslToRgb(e,t,o){let s,a,l;if(0==t)s=a=l=o;else{let n=.5>o?o*(1+t):o+t-o*t,r=2*o-n;s=i._hue2rgb(r,n,e+1/3),a=i._hue2rgb(r,n,e),l=i._hue2rgb(r,n,e-1/3)}return[n(255*s),n(255*a),n(255*l)]}static _hue2rgb(e,o,n){return 0>n&&(n+=1),1<n&&(n-=1),.16666666666>n?e+6*(o-e)*n:.5>n?o:.66666666666>n?e+6*((o-e)*(.66666666666-n)):e}static hslToHex(e,t,o){let[n,r,s]=i.hslToRgb(e,t,o);return"#"+[n,r,s].map(t=>{const e=t.toString(16);return 1===e.length?"0"+e:e}).join("")}static rgbToHex(e,t,o){return"#"+[e,t,o].map(t=>{const e=t.toString(16);return 1===e.length?"0"+e:e}).join("")}static rgbToHsl(e,t,o){e/=255,t/=255,o/=255;let n=Math.max(e,t,o),i=Math.min(e,t,o),a=(n+i)/2,l,c;if(n==i)l=c=0;else{var m=n-i;c=.5<a?m/(2-n-i):m/(n+i);n===e?l=(t-o)/m+(t<o?6:0):n===t?l=(o-e)/m+2:n===o?l=(e-t)/m+4:void 0;l/=6}return[l,c,a]}static hslToFloat(e,t=1,n=.5){let r=i.hslToRgb(e,t,n);return o(r[0]+256*r[1]+256*(256*r[2]))}static rgbToFloat(e,t,n){return o(e+256*t+256*(256*n))}static hexToFloat(e){let t=i.hexToRgb(e);return i.rgbToFloat(t[0],t[1],t[2])}static floatToRgb(e){let t=o(e/65536),n=o((e-t*65536)/256),i=o(e-t*65536-256*n);return[i,n,t]}static floatToHsl(e){let t=o(e/65536),n=o((e-t*65536)/256),s=o(e-t*65536-256*n);return i.rgbToHsl(s,n,t)}static gdbHueShift(e){return e=.85*e+.66,1<e&&--e,e=1-e+.33,1<e&&--e,e}}t.exports=i},{}],12:[function(e,t){"use strict";t.exports={points:0,lines:1,lineStrip:2,lineLoop:3,triangles:4,traingleStrip:5,triangleFan:6}},{}],13:[function(e,t){"use strict";const o=e("../Shaders");t.exports=class{constructor(e,t){this.renderer=e,this.gl=this.renderer.gl,this.framebuffer=this.initFramebuffer(),this.texture=this.initTexture(),this.renderbuffer=this.initRenderbuffer(),this.shader=o[t].clone(),this.shader.init(this.renderer.gl),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}initBuffer(){let e=this.gl,t=e.getAttribLocation(this.shader.program,"v_coord"),o=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,-1,-1,-1,-1,1,-1,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),o}initTexture(){let e=this.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.renderer.getWidth(),this.renderer.getHeight(),0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),t}initFramebuffer(){let e=this.gl,t=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,t),t}initRenderbuffer(){let e=this.gl,t=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,t),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this.renderer.getWidth(),this.renderer.getHeight()),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),t}bind(){let e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}unbind(){let e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),this.initBuffer(),this.shader.use(),e.drawArrays(e.TRIANGLES,0,6)}}},{"../Shaders":57}],14:[function(e,t){"use strict";const o=e("./DrawModes"),n=e("./Attribute"),r=e("../Math/Matrix4f"),i=e("./Node");t.exports=class extends i{constructor(e,t,o){super(),this.type="Lore.Geometry",this.name=e,this.gl=t,this.shader=o,this.attributes={},this.drawMode=this.gl.POINTS,this.isVisible=!0,this.stale=!1}addAttribute(e,t,o){return this.attributes[e]=new n(t,o,e),this.attributes[e].createBuffer(this.gl,this.shader.program),this}updateAttribute(e,t){return t&&(this.attributes[e].data=t),this.attributes[e].update(this.gl),this}getAttribute(e){return this.attributes[e]}removeAttribute(e){return delete this.attributes[e],this}setMode(e){return e===o.points?this.drawMode=this.gl.POINTS:e===o.lines?this.drawMode=this.gl.LINES:e===o.lineStrip?this.drawMode=this.gl.LINE_STRIP:e===o.lineLoop?this.drawMode=this.gl.LINE_LOOP:e===o.triangles?this.drawMode=this.gl.TRIANGLES:e===o.triangleStrip?this.drawMode=this.gl.TRIANGLE_STRIP:e===o.triangleFan?this.drawMode=this.gl.TRIANGLE_FAN:void 0,this}size(){return 0<Object.keys(this.attributes).length?this.attributes[Object.keys(this.attributes)[0]].size:0}hide(){this.isVisible=!1}show(){this.isVisible=!0,this.stale=!0}draw(e){if(this.isVisible){for(let e in this.attributes)this.attributes[e].stale&&this.attributes[e].update(this.gl);if(this.shader.use(),(e.camera.isProjectionMatrixStale||this.stale)&&this.shader.uniforms.projectionMatrix.setValue(e.camera.getProjectionMatrix()),e.camera.isViewMatrixStale||this.stale){let t=r.multiply(e.camera.viewMatrix,this.modelMatrix);this.shader.uniforms.modelViewMatrix.setValue(t.entries)}for(let e in this.shader.updateUniforms(),this.attributes)this.attributes[e].bind(this.gl);this.gl.drawArrays(this.drawMode,0,this.size()),this.stale=!1}}}},{"../Math/Matrix4f":38,"./Attribute":10,"./DrawModes":12,"./Node":16}],15:[function(e,t){"use strict";var o=Math.sin,n=Math.cos,r=Math.log,s=Math.abs,a=Math.sqrt,c=Math.pow;class m{constructor(e){this.adjacencyMatrix=e;for(var t=0;t<this.adjacencyMatrix.length;t++)for(var o=0;o<this.adjacencyMatrix.length;o++)0===this.adjacencyMatrix[t][o]&&(this.adjacencyMatrix[t][o]=1/0);this.distanceMatrix=this.getDistanceMatrix(),this.diameter=this.getDiameter()}getUnweightedAdjacencyMatrix(){let e=this.adjacencyMatrix.length,t=Array(e);for(var o=0;o<e;o++){t[o]=new Uint8Array(e);for(var n=0;n<e;n++)t[o][n]=0<this.adjacencyMatrix[o][n]?1:0}return t}getEdgeList(){let e=this.adjacencyMatrix.length,t=[];for(var o=0;o<e-1;o++)for(var n=o;n<e;n++)this.adjacencyMatrix[o][n]!==1/0&&t.push([o,n,this.adjacencyMatrix[o][n]]);return t}forceLayout(e=1e3,t=1e3,o=1.5,r=.01,l=1e3,m=1){var d=Math.sign;let p=this.distanceMatrix.slice(),u=p.length,g=new Int16Array(u);for(var h=0;h<u;h++)g[h]=this.adjacencyMatrix[h].reduce((e,t)=>t===1/0?e:++e,0);for(var h=0;h<u;h++)for(var x=0;x<u;x++)p[h][x]=c(p[h][x],o);let f=0;for(var h=0;h<u;h++)for(var x=0;x<u;x++)p[h][x]>f&&(f=p[h][x]);for(var h=0;h<u;h++)for(var x=0;x<u;x++)p[h][x]/=f;let v=new Float32Array(u),y=new Float32Array(u),b=new Float32Array(u),P=new Float32Array(u);for(var h=0;h<u;h++)b[h]=Math.random()*e,P[h]=Math.random()*e;for(var N=0;N<t;N++){for(var h=0;h<u-1;h++)for(var x=h+1;x<u;x++){if(p[h][x]===1/0)continue;let t=b[h]-b[x],o=P[h]-P[x],n=a(c(t,2)+c(o,2));0===n&&(n=.01),t/=n,o/=n;let i=r*(p[h][x]*e-n);this.adjacencyMatrix[h][x]!==1/0&&(i*=u),v[h]+=i*t,y[h]+=i*o,v[x]+=-i*t,y[x]+=-i*o}for(var h=0;h<u-1;h++)for(var x=h;x<u;x++)for(var x=h;x<u;x++){if(this.adjacencyMatrix[h][x]!==1/0)continue;let e=b[h]-b[x],t=P[h]-P[x],o=c(e,2)+c(t,2),n=a(o);0===n&&(n=.01),0===o&&(o=.05),e/=n,t/=n;let r=l/o;v[h]+=r*e,y[h]+=r*t,v[x]+=-r*e,y[x]+=-r*t}for(var h=0;h<u;h++)v[h]=d(v[h])*a(s(v[h])),y[h]=d(y[h])*a(s(y[h])),b[h]+=v[h],P[h]+=y[h];for(var h=0;h<u;h++)v[h]=0,y[h]=0}let _=0,A=0;for(var h=0;h<u;h++)b[h]*=m,P[h]*=m,_+=b[h],A+=P[h];_/=u,A/=u;for(var h=0;h<u;h++)b[h]-=_-e/2,P[h]-=A-e/2;let S=Array(u);for(var h=0;h<u;h++)S[h]=[b[h],P[h]];return[S,this.getEdgeList()]}kkLayout(e=500,t=!1,s=!1,m=!1){let d=this.distanceMatrix,p=this.distanceMatrix.length;if(t)for(var f=0;f<p;f++)for(var u=0;u<p;u++)d[f][u]!==1/0&&(d[f][u]=r(d[f][u]));if(m)for(var f=0;f<p;f++)for(var u=0;u<p;u++)d[f][u]!==1/0&&0!==d[f][u]&&(d[f][u]=c(d[f][u],2));if(m){let e=0;for(var f=0;f<p;f++)for(var u=0;u<p;u++)d[f][u]>e&&d[f][u]!==1/0&&(e=d[f][u]);for(var f=0;f<p;f++)for(var u=0;u<p;u++)d[f][u]!==1/0&&(d[f][u]/=e)}let g=2*Math.PI/p,h=0,x=new Float32Array(p),v=new Float32Array(p),y=Array(p),b=e/(2*this.diameter);console.log("l: "+b),console.log("diameter: "+this.diameter),e/=2;for(var f=p;f--;)x[f]=e+n(h)*e,v[f]=e+o(h)*e,y[f]=!1,h+=g;let l=Array(p);for(f=p;f--;){l[f]=Array(p);for(var u=p;u--;)l[f][u]=b*d[f][u]}let P=Array(p);for(f=p;f--;){P[f]=Array(p);for(var u=p;u--;)P[f][u]=50*c(d[f][u],-2)}let N=Array(p),_=new Float32Array(p),A=new Float32Array(p);for(f=p;f--;)N[f]=Array(p);f=p;for(let o,n,r,i,c,d,u;f--;){o=x[f],n=v[f],r=0,i=0;for(let e=p;e--;)f!==e&&(c=x[e],d=v[e],u=1/a((o-c)*(o-c)+(n-d)*(n-d)),N[f][e]=[P[f][e]*(o-c-l[f][e]*(o-c)*u)||0,P[f][e]*(n-d-l[f][e]*(n-d)*u)||0],N[e][f]=N[f][e],r+=N[f][e][0],i+=N[f][e][1]);_[f]=r,A[f]=i}let S=function(e){return[_[e]*_[e]+A[e]*A[e],_[e],A[e]]},C=function(){let e=0,t=0,o=0,n=0;for(f=p;f--;){let[r,i,s]=S(f);r>e&&(e=r,t=f,o=i,n=s)}return[t,e,o,n]},E=function(e,t,o){let n=0,r=0,i=0,s=x[e],d=v[e],u=l[e],g=P[e];for(f=p;f--;){if(f===e)continue;let t=x[f],o=v[f],a=u[f],l=g[f],p=(s-t)*(s-t),m=1/c(p+(d-o)*(d-o),1.5);n+=l*(1-a*(d-o)*(d-o)*m)||0,r+=l*(1-a*p*m)||0,i+=l*(a*(s-t)*(d-o)*m)||0}0==n&&(n=.1),0===r&&(r=.1),0===i&&(i=.1);let h=t/n+o/i;h/=i/n-r/i;let m=-(i*h+t)/n;x[e]+=m,v[e]+=h;let y=N[e];t=0,o=0,s=x[e],d=v[e];let b,S,C,E,M;for(f=p;f--;)e!==f&&(b=x[f],S=v[f],C=y[f][0],E=y[f][1],M=1/a((s-b)*(s-b)+(d-S)*(d-S)),m=g[f]*(s-b-u[f]*(s-b)*M)||0,h=g[f]*(d-S-u[f]*(d-S)*M)||0,y[f]=[m,h],t+=m,o+=h,_[f]+=m-C,A[f]+=h-E);_[e]=t,A[e]=o},M=1e9,T=0,z=0,L=0,F=0,D=0,U=0;for(;M>.1&&6e3>D;)for(D++,[T,M,z,L]=C(),F=M,U=0;F>.1&&10>U;)U++,E(T,z,L),[F,z,L]=S(T);let w=Array(p);for(f=p;f--;)w[f]=[x[f],v[f]];return[w,this.getEdgeList()]}getDiameter(){let e=0;for(var t=0;t<this.distanceMatrix.length-1;t++)for(var o=t;o<this.distanceMatrix.length;o++)this.distanceMatrix[t][o]>e&&this.distanceMatrix[t][o]<1/0&&(e=this.distanceMatrix[t][o]);return e}getDistanceMatrix(){let e=this.adjacencyMatrix.length,t=Array(e);for(var o=0;o<e;o++)t[o]=new Float32Array(e),t[o].fill(1/0);for(var o=0;o<e;o++)for(var n=0;n<e;n++)this.adjacencyMatrix[o][n]<1/0&&(t[o][n]=this.adjacencyMatrix[o][n]);for(var r=0;r<e;r++)for(var o=0;o<e;o++)for(var n=0;n<e;n++)t[o][n]>t[o][r]+t[r][n]&&(t[o][n]=t[o][r]+t[r][n]);return t}static fromEdgeList(e,t=!1){let o=0;for(var n=0;n<e.length;n++)e[n][0]>o&&(o=e[n][0]),e[n][1]>o&&(o=e[n][1]);if(o++,t){let t=0;for(var n=0;n<e.length;n++)e[n][2]>t&&(t=e[n][2]);t++;for(var n=0;n<e.length;n++)e[n][2]=t-e[n][2]}let r=Array(o);for(var n=0;n<o;n++)r[n]=new Float32Array(o),r[n].fill(0);for(var n=0;n<e.length;n++){let t=e[n];r[t[0]][t[1]]=t[2],r[t[1]][t[0]]=t[2]}return new m(r)}}t.exports=m},{}],16:[function(e,t){"use strict";const o=e("../Math/Vector3f"),n=e("../Math/Quaternion"),r=e("../Math/Matrix3f"),i=e("../Math/Matrix4f");class s{constructor(){this.type="Node",this.id=s.createGUID(),this.isVisible=!0,this.position=new o(0,0,0),this.rotation=new n(0,0,0,0),this.scale=new o(1,1,1),this.up=new o(0,1,0),this.normalMatrix=new r,this.modelMatrix=new i,this.isStale=!1,this.children=[],this.parent=null}applyMatrix(e){return this.modelMatrix.multiplyB(e),this}getUpVector(){let e=new o(0,1,0);return e.applyQuaternion(this.rotation)}getForwardVector(){let e=new o(0,0,1);return e.applyQuaternion(this.rotation)}getRightVector(){let e=new o(1,0,0);return e.applyQuaternion(this.rotation)}translateOnAxis(e,t){let n=new o(e.components[0],e.components[1],e.components[2]);return n.applyQuaternion(this.rotation),n.multiplyScalar(t),this.position.add(n),this}translateX(e){return this.position.components[0]+=e,this}translateY(e){return this.position.components[1]+=e,this}translateZ(e){return this.position.components[2]+=e,this}setTranslation(e){return this.position=e,this}setRotation(e,t){return this.rotation.setFromAxisAngle(e,t),this}rotate(e,t){let o=new n(e,t);return this.rotation.multiplyA(o),this}rotateX(e){return this.rotation.rotateX(e),this}rotateY(e){return this.rotation.rotateY(e),this}rotateZ(e){return this.rotation.rotateZ(e),this}getRotationMatrix(){return this.rotation.toRotationMatrix()}update(){return this.modelMatrix.compose(this.position,this.rotation,this.scale),this.isStale=!0,this}getModelMatrix(){return this.modelMatrix.entries}static createGUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=0|16*Math.random(),o="x"==e?t:8|3&t;return o.toString(16)})}}t.exports=s},{"../Math/Matrix3f":37,"../Math/Matrix4f":38,"../Math/Quaternion":40,"../Math/Vector3f":45}],17:[function(e,t){"use strict";var o=Math.round;const n=e("../Shaders"),r=e("./Effect"),i=e("../Math/Vector3f"),s=e("./Color"),a=e("../Utils/Utils"),l=e("./Geometry"),c=e("../Controls/ControlsBase"),m=e("../Controls/OrbitalControls"),d=e("../Cameras/CameraBase"),p=e("../Cameras/OrthographicCamera");t.exports=class{constructor(e,t){this.defaults={antialiasing:!0,verbose:!1,fpsElement:document.getElementById("fps"),clearColor:s.fromHex("#000000"),clearDepth:1,radius:500,center:new i(0,0,0),enableDepthTest:!0,alphaBlending:!1,preserveDrawingBuffer:!1},this.opts=a.extend(!0,this.defaults,t),this.canvas=document.getElementById(e),this.webgl2=!0,this.parent=this.canvas.parentElement,this.fps=0,this.fpsCount=0,this.maxFps=1e3/30,this.devicePixelRatio=this.getDevicePixelRatio(),this.camera=new p(this.getWidth()/-2,this.getWidth()/2,this.getHeight()/2,this.getHeight()/-2),this.geometries={},this.ready=!1,this.gl=null,this.render=function(){},this.effect=null,this.lastTiming=performance.now(),this.disableContextMenu();let o=this;o.init();let n=t.center?t.center:new i(0,0,0);this.controls=new m(o,this.opts.radius||500,n)}init(){let e=this,t={antialias:this.opts.antialiasing,preserveDrawingBuffer:this.opts.preserveDrawingBuffer};if(this.gl=this.canvas.getContext("webgl2",t)||this.canvas.getContext("experimental-webgl2"),this.gl||(this.webgl2=!1,this.gl=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t)),!this.gl)return void console.error("Could not initialize the WebGL context.");let o=this.gl;if(this.opts.verbose){let e=o.getContextAttributes().antialias,t=o.getParameter(o.SAMPLES);console.info("Antialiasing: "+e+" ("+t+"x)");let n=o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT),r=0!=n.precision;console.info("High precision support: "+r),console.info("WebGL2 supported: "+this.webgl2)}let n=o.getExtension("OES_standard_derivatives");null===n&&console.warn("Could not load extension: OES_standard_derivatives.");let r=o.getExtension("WEBGL_draw_buffers");null===r&&console.warn("Could not load extension: WEBGL_draw_buffers.");let i=o.getExtension("WEBGL_depth_texture");null===i&&console.warn("Could not load extension: WEBGL_depth_texture.");let s=o.getExtension("EXT_frag_depth");null===s&&console.warn("Could not load extension: EXT_frag_depth."),this.setClearColor(this.opts.clearColor),this.opts.alphaBlending?(o.disable(o.DEPTH_TEST),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ZERO,o.ONE),o.enable(o.BLEND)):(o.clearDepth(this.opts.clearDepth),this.opts.enableTransparency?(o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.enable(o.BLEND),o.disable(o.DEPTH_TEST)):this.opts.enableDepthTest&&(o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),this.opts.verbose&&console.log("enable depth test"))),this.ready=!0,this.animate()}disableContextMenu(){this.canvas.addEventListener("contextmenu",function(t){if(2===t.button)return t.preventDefault(),!1})}setClearColor(e){this.opts.clearColor=e;let t=this.opts.clearColor.components;this.gl.clearColor(t[0],t[1],t[2],t[3])}getWidth(){return this.canvas.offsetWidth}getHeight(){return this.canvas.offsetHeight}updateViewport(e,t,o,n){o*=this.devicePixelRatio,n*=this.devicePixelRatio,this.canvas.width=o,this.canvas.height=n,this.gl.viewport(e,t,o,n),this.camera.updateViewport(o,n),this.camera.updateProjectionMatrix()}animate(){this.updateViewport(0,0,this.getWidth(),this.getHeight());let e=this;if(setTimeout(function(){requestAnimationFrame(function(){e.animate()})},this.maxFps),this.opts.fpsElement){let e=performance.now(),t=e-this.lastTiming;this.lastTiming=e,10>this.fpsCount?(this.fps+=o(1e3/t),this.fpsCount++):(this.opts.fpsElement.innerHTML=o(this.fps/this.fpsCount),this.fpsCount=0,this.fps=0)}this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.render(this.camera,this.geometries),this.camera.isProjectionMatrixStale=!1,this.camera.isViewMatrixStale=!1}createGeometry(e,t){let o=n[t].clone();o.init(this.gl,this.webgl2);let r=new l(e,this.gl,o);return this.geometries[e]=r,r}setMaxFps(e){this.maxFps=e}getDevicePixelRatio(){return window.devicePixelRatio||1}}},{"../Cameras/CameraBase":2,"../Cameras/OrthographicCamera":3,"../Controls/ControlsBase":6,"../Controls/OrbitalControls":8,"../Math/Vector3f":45,"../Shaders":57,"../Utils/Utils":62,"./Color":11,"./Effect":13,"./Geometry":14}],18:[function(e,t){"use strict";const o=e("./Uniform"),n=e("../Math/Matrix4f");class r{constructor(e,t,r,i,s,a="circle"){this.name=e,this.uniforms=r||{},this.vertexShader=i||[],this.fragmentShader=s||[],this.glVersion=t,this.fallback=a,this.gl=null,this.program=null,this.initialized=!1,this.lastTime=new Date().getTime(),this.uniforms.modelViewMatrix=new o("modelViewMatrix",new n().entries,"float_mat4"),this.uniforms.projectionMatrix=new o("projectionMatrix",new n().entries,"float_mat4")}clone(){let e={};for(let t in this.uniforms)e[t]=this.uniforms[t].clone();return new r(this.name,this.glVersion,e,this.vertexShader,this.fragmentShader)}getVertexShaderCode(){return this.vertexShader.join("\n")}getFragmentShaderCode(){return this.fragmentShader.join("\n")}getVertexShader(e,t=!1){let o=e.createShader(e.VERTEX_SHADER),n="";if(!t&&2===this.glVersion)throw"The shader expects WebGL 2.0";else 2===this.glVersion&&(n+="#version 300 es\n");return n+="uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\n"+this.getVertexShaderCode(),e.shaderSource(o,n),e.compileShader(o),r.showCompilationInfo(e,o,this.name,"Vertex Shader"),o}getFragmentShader(e,t=!1){let o=e.createShader(e.FRAGMENT_SHADER),n="";if(!t&&2===this.glVersion)throw"The shader expects WebGL 2.0";else 2===this.glVersion&&(n+="#version 300 es\n");return n+="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n"+this.getFragmentShaderCode(),e.shaderSource(o,n),e.compileShader(o),r.showCompilationInfo(e,o,this.name,"Fragment Shader"),o}init(e,t=!1){this.gl=e,this.program=this.gl.createProgram();let o=this.getVertexShader(this.gl,t),n=this.getFragmentShader(this.gl,t);return o&&n?(this.gl.attachShader(this.program,o),this.gl.attachShader(this.program,n),this.gl.linkProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)?void(this.initialized=!0):(console.error("Could not link program.\nVALIDATE_STATUS: "+this.gl.getProgramParameter(this.program,this.gl.VALIDATE_STATUS)+"\nERROR: "+this.gl.getError()),null)):(console.error("Failed to create the fragment or the vertex shader."),null)}updateUniforms(){if(this.uniforms.time){let e=this.uniforms.time,t=new Date().getTime();e.value+=t-this.lastTime,this.lastTime=t,o.Set(this.gl,this.program,e),e.stale=!1}for(let e in this.uniforms){let t=this.uniforms[e];t.stale&&o.Set(this.gl,this.program,t)}}use(){this.gl.useProgram(this.program),this.updateUniforms()}static showCompilationInfo(e,t,o,n){n=n||"Shader",!1===e.getShaderParameter(t,e.COMPILE_STATUS)&&console.error(n+" "+o+" did not compile."),""!==e.getShaderInfoLog(t)&&console.warn(n+" "+o+" info log: "+e.getShaderInfoLog(t))}}t.exports=r},{"../Math/Matrix4f":38,"./Uniform":20}],19:[function(e,t){"use strict";var o=Math.pow;class n{constructor(e,t){this.tree=e,this.weights=t}layout(){let e=new Uint8Array(this.tree.length),t=new Float32Array(this.tree.length),n=new Float32Array(this.tree.length),r=[0];e[0]=1;let s=null;for(t[0]=20,n[0]=10;0<r.length;){s=r.shift();let i=0;for(var a=0;a<this.tree[s].length;a++){let c=this.tree[s][a];if(0===e[c]){t[c]=t[s]+5*this.weights[s][a],n[c]=n[s]+10*i++*this.weights[s][a];for(var l=0;l<length;l++){if(0===e[l])continue;let r=o(t[l]-t[c],2)+o(n[l]-n[c],2),i=Math.sqrt(r)}e[c]=1,r.push(c)}}}let c=Array(this.tree.length);for(var a=0;a<this.tree.length;a++)c[a]=[t[a],n[a]];return c}static fromEdgeList(e){let t=0;for(var o=0;o<e.length;o++)e[o][0]>t&&(t=e[o][0]),e[o][1]>t&&(t=e[o][1]);t++;let r=Array(t),s=Array(t);for(var o=0;o<t;o++)r[o]=[],s[o]=[];for(var o=0;o<e.length;o++)r[e[o][0]].push(e[o][1]),r[e[o][1]].push(e[o][0]),s[e[o][0]].push(e[o][2]),s[e[o][1]].push(e[o][2]);return new n(r,s)}}t.exports=n},{}],20:[function(e,t){"use strict";class o{constructor(e,t,o){this.name=e,this.value=t,this.type=o,this.stale=!0}clone(){return new o(this.name,this.value,this.type)}setValue(e){this.value=e,this.stale=!0}static Set(e,t,o){let n=e.getUniformLocation(t,o.name);"int"===o.type?e.uniform1i(n,o.value):"int_vec2"===o.type?e.uniform2iv(n,o.value):"int_vec3"===o.type?e.uniform3iv(n,o.value):"int_vec4"===o.type?e.uniform4iv(n,o.value):"int_array"===o.type?e.uniform1iv(n,o.value):"float"===o.type?e.uniform1f(n,o.value):"float_vec2"===o.type?e.uniform2fv(n,o.value):"float_vec3"===o.type?e.uniform3fv(n,o.value):"float_vec4"===o.type?e.uniform4fv(n,o.value):"float_array"===o.type?e.uniform1fv(n,o.value):"float_mat2"===o.type?e.uniformMatrix2fv(n,!1,o.value):"float_mat3"===o.type?e.uniformMatrix3fv(n,!1,o.value):"float_mat4"===o.type&&e.uniformMatrix4fv(n,!1,o.value),o.stale=!0}}t.exports=o},{}],21:[function(e,t){"use strict";const o=e("./Attribute"),n=e("./Color"),r=e("./DrawModes"),i=e("./Effect"),s=e("./Geometry"),a=e("./Graph"),l=e("./Node"),c=e("./Renderer"),m=e("./Shader"),d=e("./Tree"),p=e("./Uniform");t.exports={Attribute:o,Color:n,DrawModes:r,Effect:i,Geometry:s,Graph:a,Node:l,Renderer:c,Shader:m,Tree:d,Uniform:p}},{"./Attribute":10,"./Color":11,"./DrawModes":12,"./Effect":13,"./Geometry":14,"./Graph":15,"./Node":16,"./Renderer":17,"./Shader":18,"./Tree":19,"./Uniform":20}],22:[function(e,t){"use strict";e("../Core/Geometry");t.exports=class{constructor(e,t){this.type="Lore.FilterBase",this.geometry=null,this.attribute=e,this.attributeIndex=t,this.active=!1}getGeometry(){return this.geometry}setGeometry(e){this.geometry=e}filter(){}reset(){}static isVisible(e,t){return 0<e.attributes.color.data[3*t+2]}}},{"../Core/Geometry":14}],23:[function(e,t){"use strict";var o=Math.abs;const n=e("./FilterBase"),r=e("../Core/Color");t.exports=class extends n{constructor(e,t,o,n){super(e,t),this.min=o,this.max=n}getMin(){return this.min}setMin(e){this.min=e}getMax(){return this.max}setMax(e){this.max=e}filter(){let e=this.geometry.attributes[this.attribute],t="color"===this.attribute&&0===this.attributeIndex;for(let n=0,i;n<e.data.length;n+=e.attributeLength){i=e.data[n+this.attributeIndex],t&&(i=r.floatToHsl(i)[0]);let s=this.geometry.attributes.color.data[n+2];this.geometry.attributes.color.data[n+2]=i>this.max||i<this.min?-o(s):o(s)}this.geometry.updateAttribute("color")}reset(){let e=this.geometry.attributes[this.attribute];for(let t=0,n;t<e.data.length;t+=e.attributeLength)n=this.geometry.attributes.color.data[t+2],this.geometry.attributes.color.data[t+2]=o(n);this.geometry.updateAttribute("color")}}},{"../Core/Color":11,"./FilterBase":22}],24:[function(e,t){"use strict";const o=e("./FilterBase"),n=e("./InRangeFilter");t.exports={FilterBase:o,InRangeFilter:n}},{"./FilterBase":22,"./InRangeFilter":23}],25:[function(e,t){"use strict";const o=e("../Core/DrawModes"),n=e("./HelperBase"),r=e("../Utils/Utils");class i extends n{constructor(e,t,n,s,a){super(e,n,s);let l=new Float32Array(3*(24*t.length)),m=new Float32Array(3*(24*t.length)),c=0;for(let o=0;o<t.length;o++){let e=t[0],o=e.center.components[0],n=e.center.components[1],i=e.center.components[2],s=e.radius,r=[o-s,n-s,i-s],a=[o-s,n-s,i+s],m=[o-s,n+s,i-s],d=[o-s,n+s,i+s],p=[o+s,n-s,i-s],f=[o+s,n-s,i+s],u=[o+s,n+s,i-s],g=[o+s,n+s,i+s];l[c++]=r[0],l[c++]=r[1],l[c++]=r[2],l[c++]=a[0],l[c++]=a[1],l[c++]=a[2],l[c++]=r[0],l[c++]=r[1],l[c++]=r[2],l[c++]=m[0],l[c++]=m[1],l[c++]=m[2],l[c++]=r[0],l[c++]=r[1],l[c++]=r[2],l[c++]=p[0],l[c++]=p[1],l[c++]=p[2],l[c++]=a[0],l[c++]=a[1],l[c++]=a[2],l[c++]=d[0],l[c++]=d[1],l[c++]=d[2],l[c++]=a[0],l[c++]=a[1],l[c++]=a[2],l[c++]=f[0],l[c++]=f[1],l[c++]=f[2],l[c++]=m[0],l[c++]=m[1],l[c++]=m[2],l[c++]=d[0],l[c++]=d[1],l[c++]=d[2],l[c++]=m[0],l[c++]=m[1],l[c++]=m[2],l[c++]=u[0],l[c++]=u[1],l[c++]=u[2],l[c++]=d[0],l[c++]=d[1],l[c++]=d[2],l[c++]=g[0],l[c++]=g[1],l[c++]=g[2],l[c++]=p[0],l[c++]=p[1],l[c++]=p[2],l[c++]=f[0],l[c++]=f[1],l[c++]=f[2],l[c++]=p[0],l[c++]=p[1],l[c++]=p[2],l[c++]=u[0],l[c++]=u[1],l[c++]=u[2],l[c++]=f[0],l[c++]=f[1],l[c++]=f[2],l[c++]=g[0],l[c++]=g[1],l[c++]=g[2],l[c++]=u[0],l[c++]=u[1],l[c++]=u[2],l[c++]=g[0],l[c++]=g[1],l[c++]=g[2]}this.opts=r.extend(!0,i.defaults,a),this.geometry.setMode(o.lines),this.setAttribute("position",l),this.setAttribute("color",m)}}t.exports=i},{"../Core/DrawModes":12,"../Utils/Utils":62,"./HelperBase":27}],26:[function(e,t){"use strict";var o=Math.abs;const n=e("../Core/Color"),r=e("./HelperBase"),i=e("../Math/Vector3f"),s=e("../Utils/Utils"),a=e("../Core/DrawModes"),l=e("./PointHelper");class c extends r{constructor(e,t,o="coordinates",r={}){super(e,t,o),this.defaults={position:new i(0,0,0),axis:{x:{length:50,color:n.fromHex("#222222")},y:{length:50,color:n.fromHex("#222222")},z:{length:50,color:n.fromHex("#222222")}},ticks:{enabled:!0,x:{count:10,length:5,offset:new i(0,0,0),color:n.fromHex("#1f1f1f")},y:{count:10,length:5,offset:new i(0,0,0),color:n.fromHex("#1f1f1f")},z:{count:10,length:5,offset:new i(0,0,0),color:n.fromHex("#1f1f1f")}},box:{enabled:!0,x:{color:n.fromHex("#222222")},y:{color:n.fromHex("#222222")},z:{color:n.fromHex("#222222")}}},this.opts=s.extend(!0,this.defaults,r),this.geometry.setMode(a.lines),this.init()}init(){let e=this.opts.position.components,t=this.opts.axis,o=[e[0],e[1],e[2],e[0]+t.x.length,e[1],e[2],e[0],e[1],e[2],e[0],e[1]+t.y.length,e[2],e[0],e[1],e[2],e[0],e[1],e[2]+t.z.length],n=t.x.color.components,r=t.y.color.components,i=t.z.color.components,s=[n[0],n[1],n[2],n[0],n[1],n[2],r[0],r[1],r[2],r[0],r[1],r[2],i[0],i[1],i[2],i[0],i[1],i[2]];if(this.opts.box.enabled){let n=this.opts.box.x.color.components,r=this.opts.box.y.color.components,i=this.opts.box.z.color.components;o.push(e[0]+t.x.length,e[1]+t.y.length,e[2]+t.z.length,e[0],e[1]+t.y.length,e[2]+t.z.length,e[0]+t.x.length,e[1],e[2]+t.z.length,e[0],e[1],e[2]+t.z.length,e[0]+t.x.length,e[1]+t.y.length,e[2],e[0],e[1]+t.y.length,e[2],e[0]+t.x.length,e[1]+t.y.length,e[2]+t.z.length,e[0]+t.x.length,e[1],e[2]+t.z.length,e[0],e[1]+t.y.length,e[2]+t.z.length,e[0],e[1],e[2]+t.z.length,e[0]+t.x.length,e[1]+t.y.length,e[2],e[0]+t.x.length,e[1],e[2],e[0]+t.x.length,e[1]+t.y.length,e[2]+t.z.length,e[0]+t.x.length,e[1]+t.y.length,e[2],e[0],e[1]+t.y.length,e[2]+t.z.length,e[0],e[1]+t.y.length,e[2],e[0]+t.x.length,e[1],e[2]+t.z.length,e[0]+t.x.length,e[1],e[2]),s.push(n[0],n[1],n[2],n[0],n[1],n[2],n[0],n[1],n[2],n[0],n[1],n[2],n[0],n[1],n[2],n[0],n[1],n[2],r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2],i[0],i[1],i[2],i[0],i[1],i[2],i[0],i[1],i[2],i[0],i[1],i[2],i[0],i[1],i[2],i[0],i[1],i[2])}if(this.opts.ticks.enabled){let n=this.opts.ticks.x,r=t.x.length/n.count,a=this.opts.ticks.y,l=t.y.length/a.count,c=this.opts.ticks.z,m=t.z.length/c.count,d=e[0],p=n.color.components;for(let t=0;t<n.count-1;t++)d+=r,o.push(d+n.offset.components[0],e[1]+n.offset.components[1],e[2]+n.offset.components[2],d+n.offset.components[0],e[1]+n.offset.components[1]+n.length,e[2]+n.offset.components[2]),s.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[0];for(let t=0;t<n.count-1;t++)d+=r,o.push(d+n.offset.components[0],e[1]+n.offset.components[1],e[2]+n.offset.components[2],d+n.offset.components[0],e[1]+n.offset.components[1],e[2]+n.offset.components[2]+n.length),s.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[1],p=a.color.components;for(let t=0;t<a.count-1;t++)d+=l,o.push(e[0]+a.offset.components[0],d+a.offset.components[1],e[2]+a.offset.components[2],e[0]+a.offset.components[0]+a.length,d+a.offset.components[1],e[2]+a.offset.components[2]),s.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[1];for(let t=0;t<a.count-1;t++)d+=l,o.push(e[0]+a.offset.components[0],d+a.offset.components[1],e[2]+a.offset.components[2],e[0]+a.offset.components[0],d+a.offset.components[1],e[2]+a.offset.components[2]+a.length),s.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[2],p=c.color.components;for(let t=0;t<c.count-1;t++)d+=m,o.push(e[0]+c.offset.components[0],e[1]+c.offset.components[1],d+c.offset.components[2],e[0]+c.offset.components[0],e[1]+c.offset.components[1]+c.length,d+c.offset.components[2]),s.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[2];for(let t=0;t<c.count-1;t++)d+=m,o.push(e[0]+c.offset.components[0],e[1]+c.offset.components[1],d+c.offset.components[2],e[0]+c.offset.components[0]+c.length,e[1]+c.offset.components[1],d+c.offset.components[2]),s.push(p[0],p[1],p[2],p[0],p[1],p[2])}this.setAttribute("position",new Float32Array(o)),this.setAttribute("color",new Float32Array(s))}static fromPointHelper(e,t={}){let n=e.renderer,r=e.geometry.name+"_Coordinates",i={axis:{x:{length:o(e.getDimensions().max.getX())+o(e.getDimensions().min.getX())},y:{length:o(e.getDimensions().max.getY())+o(e.getDimensions().min.getY())},z:{length:o(e.getDimensions().max.getZ())+o(e.getDimensions().min.getZ())}}};return i=s.extend(!0,i,t),new c(n,r,i)}}t.exports=c},{"../Core/Color":11,"../Core/DrawModes":12,"../Math/Vector3f":45,"../Utils/Utils":62,"./HelperBase":27,"./PointHelper":29}],27:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Geometry"),r=e("../Core/Node"),i=e("../Shaders");t.exports=class extends r{constructor(e,t,o){super(),2!==i[o].glVersion||e.webgl2||(console.warn("Switching from "+o+" to fallback shader "+i[o].fallback+" due to missing WebGL2 support."),o=i[o].fallback),this.renderer=e,this.shader=i[o].clone(),this.geometry=this.renderer.createGeometry(t,o)}hasAttribute(e){return e in this.geometry.attributes}setAttribute(e,t){this.geometry.addAttribute(e,t)}getAttribute(e){return this.geometry.attributes[e].data}updateAttribute(e,t,o){let n=this.geometry.attributes[e],r=t*n.attributeLength;for(let s=0;s<n.attributeLength;s++)n.data[r+s]=o[s]||n.data[r+s];n.stale=!0}updateAttributeAll(e,t){let o=this.geometry.attributes[e];for(let n=0;n<o.data.length;n++)o.data[n]=t[n];o.stale=!0}draw(){this.geometry.draw(this.renderer)}destruct(){}}},{"../Core/Geometry":14,"../Core/Node":16,"../Core/Shader":18,"../Shaders":57}],28:[function(e,t){"use strict";const o=e("./HelperBase"),n=e("./PointHelper"),r=e("../Spice/Octree"),i=e("../Spice/Raycaster"),s=e("../Core/DrawModes"),a=e("../Utils/Utils"),l=e("../Math/Vector3f"),c=e("../Spice/AABB"),m=e("../Math/Matrix4f"),d=e("../Filters/FilterBase"),p=e("../Math/Ray");t.exports=class extends o{constructor(e,t,o,n,r){super(e,t,o),this.defaults={visualize:!1,multiSelect:!0},this.opts=a.extend(!0,this.defaults,r),this._eventListeners={},this.target=n,this.renderer=e,this.octree=this.target.octree,this.raycaster=new i(1),this.hovered=null,this.selected=[],this.target.octreeHelper=this;let s=this;this._clickHandler=function(t){if(t.e.mouse.state.middle||t.e.mouse.state.right||!s.target.geometry.isVisible)return;let e=t.e.mouse.normalizedPosition,o=s.getIntersections(e);0<o.length&&s.addSelected(o[0])},e.controls.addEventListener("click",this._clickHandler),this._dblclickHandler=function(t){if(t.e.mouse.state.middle||t.e.mouse.state.right||!s.target.geometry.isVisible)return;let e=t.e.mouse.normalizedPosition,o=s.getIntersections(e);0<o.length&&s.addSelected(o[0])},e.controls.addEventListener("dblclick",this._dblclickHandler),this._mousemoveHandler=function(t){if(t.e.mouse.state.left||t.e.mouse.state.middle||t.e.mouse.state.right||!s.target.geometry.isVisible)return;let o=t.e.mouse.normalizedPosition,n=s.getIntersections(o);if(0<n.length){if(s.hovered&&s.hovered.index===n[0].index)return;s.hovered=n[0],s.hovered.screenPosition=s.renderer.camera.sceneToScreen(n[0].position,e),s.raiseEvent("hoveredchanged",{e:s.hovered})}else s.hovered=null,s.raiseEvent("hoveredchanged",{e:null})},e.controls.addEventListener("mousemove",this._mousemoveHandler),this._updatedHandler=function(){if(s.target.geometry.isVisible){for(let t=0;t<s.selected.length;t++)s.selected[t].screenPosition=s.renderer.camera.sceneToScreen(s.selected[t].position,e);s.hovered&&(s.hovered.screenPosition=s.renderer.camera.sceneToScreen(s.hovered.position,e)),s.raiseEvent("updated")}},e.controls.addEventListener("updated",this._updatedHandler),this.init()}init(){"centers"===this.opts.visualize?this.drawCenters():"cubes"===this.opts.visualize?this.drawBoxes():this.geometry.isVisible=!1}getScreenPosition(e){let t=this.target.geometry.attributes.position.data,o=3*e,n=new l(t[o],t[o+1],t[o+2]);return this.renderer.camera.sceneToScreen(n,this.renderer)}addSelected(e){if(!isNaN(parseFloat(e))){let t=this.target.geometry.attributes.position.data,o=3*e,n=null;this.target.hasAttribute("color")&&(n=this.target.getColor(e)),e={distance:-1,index:e,locCode:-1,position:new l(t[o],t[o+1],t[o+2]),color:n}}if(this.selectedContains(e.index))return void this.raiseEvent("reselected",{e:e});e.timestamp=Date.now();let t=this.selected.length;this.opts.multiSelect?this.selected.push(e):(this.selected[0]=e,t=0),this.selected[t].screenPosition=this.renderer.camera.sceneToScreen(e.position,this.renderer),this.raiseEvent("selectedchanged",{e:this.selected})}removeSelected(e){this.selected.splice(e,1),this.raiseEvent("selectedchanged",{e:this.selected})}clearSelected(){this.selected=[],this.raiseEvent("selectedchanged",{e:this.selected})}selectedContains(e){for(let t=0;t<this.selected.length;t++)if(this.selected[t].index===e)return!0;return!1}setHovered(e){if(this.hovered&&this.hovered.index===e)return;let t=3*e,o=this.target.geometry.attributes.position.data,n=null;this.target.hasAttribute("color")&&(n=this.target.getColor(e)),this.hovered={index:e,position:new l(o[t],o[t+1],o[t+2]),color:n},this.hovered.screenPosition=this.renderer.camera.sceneToScreen(this.hovered.position,this.renderer),this.raiseEvent("hoveredchanged",{e:this.hovered})}selectHovered(){!this.hovered||this.selectedContains(this.hovered.index)||this.addSelected({distance:this.hovered.distance,index:this.hovered.index,locCode:this.hovered.locCode,position:this.hovered.position,color:this.hovered.color})}showCenters(){this.opts.visualize="centers",this.drawCenters(),this.geometry.isVisible=!0}showCubes(){this.opts.visualize="cubes",this.drawBoxes(),this.geometry.isVisible=!0}hide(){this.opts.visualize=!1,this.geometry.isVisible=!1,this.setAttribute("position",new Float32Array([])),this.setAttribute("color",new Float32Array([]))}getIntersections(e){this.raycaster.set(this.renderer.camera,e.x,e.y);let t=this.octree.raySearch(this.raycaster),o=this.rayIntersections(t);return o.sort(function(e,t){return e.distance-t.distance}),o}getVisible(){let e=this.renderer.camera.getFrustum();console.log(e[0].toString()),console.log(e[1].toString()),this.octree.intersectBox(e[0],e[1])}addEventListener(e,t){this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t)}raiseEvent(e,t={}){if(this._eventListeners[e])for(let o=0;o<this._eventListeners[e].length;o++)this._eventListeners[e][o](t)}static joinHoveredChanged(e,t){for(let o=0;o<e.length;o++)e[o].addEventListener("hoveredchanged",function(){let o={e:null,source:null};for(let t=0;t<e.length;t++)null!==e[t].hovered&&(o={e:e[t].hovered,source:t});t(o)})}static joinSelectedChanged(e,t){for(let o=0;o<e.length;o++)e[o].addEventListener("selectedchanged",function(){let o=[];for(let t=0;t<e.length;t++)for(let n=0;n<e[t].selected.length;n++)o.push({timestamp:e[t].selected[n].timestamp,item:e[t].selected[n],index:n,source:t});t(o)})}static joinReselected(t,o){for(let e=0;e<t.length;e++)t[e].addEventListener("reselected",function(n){let e=[];for(let o=0;o<t.length;o++)e.push({item:n,source:o});o(e)})}drawCenters(){this.geometry.setMode(s.points);let e=this.octree.aabbs,t=Object.keys(e).length,o=new Float32Array(3*t),n=new Float32Array(3*t),r=0;for(var a in e){let t=e[a].center.components,i=3*r;o[i]=1,o[i+1]=1,o[i+2]=1,n[i]=t[0],n[i+1]=t[1],n[i+2]=t[2],r++}this.setAttribute("position",new Float32Array(n)),this.setAttribute("color",new Float32Array(o))}drawBoxes(){this.geometry.setMode(s.lines);let e=this.octree.aabbs,t=Object.keys(e).length,o=new Float32Array(3*(24*t)),n=new Float32Array(3*(24*t));for(let e=0;e<o.length;e++)o[e]=255;let r=0;for(var i in e){let t=c.getCorners(e[i]);n[r++]=t[0][0],n[r++]=t[0][1],n[r++]=t[0][2],n[r++]=t[1][0],n[r++]=t[1][1],n[r++]=t[1][2],n[r++]=t[0][0],n[r++]=t[0][1],n[r++]=t[0][2],n[r++]=t[2][0],n[r++]=t[2][1],n[r++]=t[2][2],n[r++]=t[0][0],n[r++]=t[0][1],n[r++]=t[0][2],n[r++]=t[4][0],n[r++]=t[4][1],n[r++]=t[4][2],n[r++]=t[1][0],n[r++]=t[1][1],n[r++]=t[1][2],n[r++]=t[3][0],n[r++]=t[3][1],n[r++]=t[3][2],n[r++]=t[1][0],n[r++]=t[1][1],n[r++]=t[1][2],n[r++]=t[5][0],n[r++]=t[5][1],n[r++]=t[5][2],n[r++]=t[2][0],n[r++]=t[2][1],n[r++]=t[2][2],n[r++]=t[3][0],n[r++]=t[3][1],n[r++]=t[3][2],n[r++]=t[2][0],n[r++]=t[2][1],n[r++]=t[2][2],n[r++]=t[6][0],n[r++]=t[6][1],n[r++]=t[6][2],n[r++]=t[3][0],n[r++]=t[3][1],n[r++]=t[3][2],n[r++]=t[7][0],n[r++]=t[7][1],n[r++]=t[7][2],n[r++]=t[4][0],n[r++]=t[4][1],n[r++]=t[4][2],n[r++]=t[5][0],n[r++]=t[5][1],n[r++]=t[5][2],n[r++]=t[4][0],n[r++]=t[4][1],n[r++]=t[4][2],n[r++]=t[6][0],n[r++]=t[6][1],n[r++]=t[6][2],n[r++]=t[5][0],n[r++]=t[5][1],n[r++]=t[5][2],n[r++]=t[7][0],n[r++]=t[7][1],n[r++]=t[7][2],n[r++]=t[6][0],n[r++]=t[6][1],n[r++]=t[6][2],n[r++]=t[7][0],n[r++]=t[7][1],n[r++]=t[7][2]}this.setAttribute("position",n),this.setAttribute("color",o)}setThreshold(e){this.raycaster.threshold=e}rayIntersections(e){let t=[],o=m.invert(this.target.modelMatrix),n=new p,r=this.raycaster.threshold*this.target.getPointScale(),s=this.target.geometry.attributes.position.data,a=this.target.getCutoff();n.copyFrom(this.raycaster.ray).applyProjection(o);let c=r;for(let o=0;o<e.length;o++){let r=e[o].index,i=e[o].locCode,m=3*r,p=new l(s[m],s[m+1],s[m+2]),f=null;this.target.hasAttribute("color")&&(f=this.target.getColor(r));let u=n.distanceSqToPoint(p);if(u<c*c){let e=n.closestPointToPoint(p);e.applyProjection(this.target.modelMatrix);let o=this.raycaster.ray.source.distanceTo(e),s=d.isVisible(this.target.geometry,r);if(o<this.raycaster.near||o>this.raycaster.far||o<a||!s)continue;t.push({distance:o,index:r,locCode:i,position:p,color:f})}}return t}destruct(){this.renderer.controls.removeEventListener("click",this._dblclickHandler),this.renderer.controls.removeEventListener("dblclick",this._dblclickHandler),this.renderer.controls.removeEventListener("mousemove",this._mousemoveHandler),this.renderer.controls.removeEventListener("updated",this._updatedHandler)}}},{"../Core/DrawModes":12,"../Filters/FilterBase":22,"../Math/Matrix4f":38,"../Math/Ray":42,"../Math/Vector3f":45,"../Spice/AABB":58,"../Spice/Octree":59,"../Spice/Raycaster":60,"../Utils/Utils":62,"./HelperBase":27,"./PointHelper":29}],29:[function(e,t){"use strict";var o=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Math.min,s=Math.max;const a=e("./HelperBase"),l=e("../Core/DrawModes"),m=e("../Core/Color"),d=e("../Utils/Utils"),p=e("../Math/Vector3f"),f=e("../Spice/AABB"),u=e("../Spice/Octree"),g=e("../Filters/FilterBase");t.exports=class extends a{constructor(e,t,r,i){super(e,t,r);this.opts=d.extend(!0,{octree:!0,octreeThreshold:500,octreeMaxDepth:8,pointScale:1,maxPointSize:100},i),this.indices=null,this.octree=null,this.octreeHelper=null,this.geometry.setMode(l.points),this.initPointSize(),this.filters={},this.pointScale=this.opts.pointScale,this.rawPointSize=1,this.pointSize=this.rawPointSize*this.pointScale,this.dimensions={min:new p(n,n,n),max:new p(o,o,o)};let s=this;this._zoomchangedHandler=function(e){let t=s.setPointSize(e+.1);s.octreeHelper&&s.octreeHelper.setThreshold(t)},e.controls.addEventListener("zoomchanged",this._zoomchangedHandler)}getMaxLength(e,t,o){return s(e.length,s(t.length,o.length))}getDimensions(){return this.dimensions}getCenter(){return new p((this.dimensions.max.getX()+this.dimensions.min.getX())/2,(this.dimensions.max.getY()+this.dimensions.min.getY())/2,(this.dimensions.max.getZ()+this.dimensions.min.getZ())/2)}getMaxRadius(){let e=this.getCenter();return e.subtract(this.dimensions.max).length()}setPositions(e){return this.setAttribute("position",e),this}setPositionsXYZ(e,t,o){const n=e.length;let r=new Float32Array(3*n);for(var s=0;s<n;s++){let n=3*s;r[n]=e[s]||0,r[n+1]=t[s]||0,r[n+2]=o[s]||0,e[s]>this.dimensions.max.getX()&&this.dimensions.max.setX(e[s]),e[s]<this.dimensions.min.getX()&&this.dimensions.min.setX(e[s]),t[s]>this.dimensions.max.getY()&&this.dimensions.max.setY(t[s]),t[s]<this.dimensions.min.getY()&&this.dimensions.min.setY(t[s]),o[s]>this.dimensions.max.getZ()&&this.dimensions.max.setZ(o[s]),o[s]<this.dimensions.min.getZ()&&this.dimensions.min.setZ(o[s])}if(this.opts.octree){let e=f.fromPoints(r),t=new Uint32Array(n);for(var s=0;s<n;s++)t[s]=s;this.octree=new u(this.opts.octreeThreshold,this.opts.octreeMaxDepth),this.octree.build(t,r,e)}return this.setAttribute("position",r),this}setXYZRGBS(e,t,o,n,r,a,l=1){const s=n.length;let d=new Float32Array(s);for(var c=0;c<s;c++)d[c]=m.rgbToFloat(n[c],r[c],a[c]);return this._setValues(e,t,o,d,l),this}setXYZHexS(e,t,o,n,r=1){const s=e.length;let a=new Float32Array(s),l=m.hexToFloat(n);for(var c=0;c<s;c++)a[c]=l;return this._setValues(e,t,o,a,r),this}setXYZHS(e,t,o,n=1,r=1){const s=e.length;let a=new Float32Array(s);if("number"!=typeof n)for(var l=0;l<s;l++)a[l]=m.hslToFloat(n[l]);else if(typeof n){n=m.hslToFloat(n);for(var l=0;l<s;l++)a[l]=n}return this._setValues(e,t,o,a,r),this}_setValues(e,t,o,n,r){let a=this.getMaxLength(e,t,o),l=new Float32Array(a);for(var c=0;c<a;c++)l[c]=0;if("number"==typeof r){let e=new Float32Array(a);for(var c=0;c<a;c++)e[c]=r;r=e}return this.setPositionsXYZ(e,t,o),this.setHSSFromArrays(n,l,r),this.renderer.camera.updateProjectionMatrix(),this.renderer.camera.updateViewMatrix(),this}setPositionsXYZHSS(e,t,o,n,r,s){console.warn("The method \"setPositionsXYZHSS\" is marked as deprecated.");let a=this.getMaxLength(e,t,o);r=new Float32Array(a);for(var l=0;l<a;l++)r[l]=0;if("number"==typeof s){let e=new Float32Array(a);for(var l=0;l<a;l++)e[l]=s;s=e}if(this.setPositionsXYZ(e,t,o),"number"==typeof n&&"number"==typeof r&&"number"==typeof s){let e=m.hslToRgb(n,1,.5);this.setHSS(m.rgbToFloat(e[0],e[1],e[2]),r,s,a)}else if("number"!=typeof n&&"number"!=typeof r&&"number"!=typeof s){for(var l=0;l<n.length;l++){let e=m.hslToRgb(n[l],1,.5);n[l]=m.rgbToFloat(e[0],e[1],e[2])}this.setHSSFromArrays(n,r,s)}else{if("number"==typeof n){let e=new Float32Array(a),t=m.hslToRgb(n,1,.5);e.fill(m.rgbToFloat(t[0],t[1],t[2])),n=e}else if("number"!=typeof n){for(var l=0;l<n.length;l++){let e=m.hslToRgb(n[l],1,.5);n[l]=m.rgbToFloat(e[0],e[1],e[2])}this.setHSSFromArrays(n,r,s)}if("number"==typeof r){let e=new Float32Array(a);e.fill(r),r=e}if("number"==typeof s){let e=new Float32Array(a);e.fill(s),s=e}this.setHSSFromArrays(n,r,s)}return this.renderer.camera.updateProjectionMatrix(),this.renderer.camera.updateViewMatrix(),this}setColors(e){return this.setAttribute("color",e),this}updateColors(e){return this.updateAttributeAll("color",e),this}updateColor(e,t){return console.warn("The method \"updateColor\" is marked as deprecated."),this.updateAttribute("color",e,t.components),this}setColor(e,t){let o=new m(t.toFloat(),this.getSaturation(e),this.getSize(e));return this.updateAttribute("color",e,o.components),this}setPointSize(e){this.rawPointSize=e,this.updatePointSize();let t=this.rawPointSize*this.opts.pointScale;return t>this.opts.maxPointSize?.5*(this.opts.maxPointSize/t):.5}updatePointSize(){let e=this.rawPointSize*this.opts.pointScale;this.pointSize=e>this.opts.maxPointSize?this.opts.maxPointSize:e,this.geometry.shader.uniforms.size.value=this.pointSize}getPointSize(){return this.geometry.shader.uniforms.size.value}getPointScale(){return this.opts.pointScale}setPointScale(e){return this.opts.pointScale=e,this.updatePointSize(),this}setFog(e,t=6){if(!this.geometry.shader.uniforms.clearColor||!this.geometry.shader.uniforms.fogDensity)return console.warn("Shader \""+this.geometry.shader.name+"\" does not support fog."),this;if("string"==typeof e){let t=m.fromHex(e);e=[t.getR(),t.getG(),t.getB(),1]}return this.geometry.shader.uniforms.clearColor.value=e,this.geometry.shader.uniforms.fogDensity.value=t,this}initPointSize(){return this.setPointSize(this.renderer.camera.zoom+.1),this}getCutoff(){return this.geometry.shader.uniforms.cutoff.value}setCutoff(e){return this.geometry.shader.uniforms.cutoff.value=e,this}getHue(e){console.warn("The method \"getHue\" is marked as deprecated. Please use \"getColor\".");let t=this.getAttribute("color");return m.floatToHsl(t[3*e])}getColor(e){let t=this.getAttribute("color");return m.floatToRgb(t[3*e])}getSaturation(e){let t=this.getAttribute("color");return t[3*e+1]}getSize(e){let t=this.getAttribute("color");return t[3*e+2]}getPosition(e){let t=this.getAttribute("position");return new p(t[3*e],t[3*e+1],t[3*e+2])}setHue(e){let t=this.getAttribute("color");if("number"==typeof e){e=m.hslToFloat(e);for(let o=0;o<t.length;o++)t[3*o]=e}else for(let o=0;o<e.length;o++)t[3*o]=m.hslToFloat(e[o]);this.setColors(t)}setSaturation(e){let t=this.getAttribute("color"),o=null,n=0;if("number"==typeof e){let n=t.length;o=new Float32Array(3*n);for(let r=0;r<3*n;r+=3)o[r]=t[r],o[r+1]=e,o[r+2]=t[r+2]}else{let r=e.length;o=new Float32Array(3*r);for(let s=0;s<3*r;s+=3)o[s]=t[s],o[s+1]=e[n++],o[s+2]=t[s+2]}this.setColors(o)}setSize(e){let t=this.getAttribute("color"),o=null,n=0;if("number"==typeof e){let n=t.length;o=new Float32Array(3*n);for(let r=0;r<3*n;r+=3)o[r]=t[r],o[r+1]=t[r+1],o[r+2]=e}else{let r=e.length;o=new Float32Array(3*r);for(let s=0;s<3*r;s+=3)o[s]=t[s],o[s+1]=t[s+1],o[s+2]=e[n++]}this.setColors(o)}setHSS(e,t,o,n){let r=new Float32Array(3*n);for(let s=0;s<3*n;s+=3)r[s]=e,r[s+1]=t,r[s+2]=o;this.setColors(r)}setRGB(e,t,o){let n=this.getAttribute("color");for(let r=0;r<n.length;r++)n[3*r]=m.rgbToFloat(e,t,o);this.setColors(n)}setRGBFromArrays(e,t,o){const n=i(i(e.length,t.length),o.length);let r=this.getAttribute("color");for(let s=0;s<n;s++)r[3*s]=m.rgbToFloat(e[s],t[s],o[s]);this.setColors(r)}setHSSFromArrays(e,t,o){let n=e.length,r=new Float32Array(3*n),s=0;if(e.length!==n&&t.length!==n&&o.length!==n)throw"Hue, saturation and size have to be arrays of length \"length\" ("+n+").";for(let a=0;a<3*n;a+=3)r[a]=e[s],r[a+1]=t[s],r[a+2]=o[s],s++;this.setColors(r)}addFilter(e,t){return t.setGeometry(this.geometry),this.filters[e]=t,this}removeFilter(e){return delete this.filters[e],this}getFilter(e){return this.filters[e]}show(){this.geometry.show()}hide(){this.geometry.hide()}destruct(){this.renderer.controls.removeEventListener("zoomchanged",this._zoomchangedHandler)}}},{"../Core/Color":11,"../Core/DrawModes":12,"../Filters/FilterBase":22,"../Math/Vector3f":45,"../Spice/AABB":58,"../Spice/Octree":59,"../Utils/Utils":62,"./HelperBase":27}],30:[function(e,t){"use strict";var o=Math.max;const n=e("./HelperBase"),r=e("../Core/DrawModes"),a=e("../Core/Color"),l=e("../Utils/Utils");t.exports=class extends n{constructor(e,t,o,n){super(e,t,o),this.defaults={pointScale:1,maxPointSize:100},this.opts=l.extend(!0,this.defaults,n),this.indices=null,this.geometry.setMode(r.lines),this.initPointSize(),this.filters={}}getMaxLength(e,t,n){return o(e.length,o(t.length,n.length))}setPositions(e){this.setAttribute("position",e)}setPositionsXYZ(e,t,o){const n=e.length;let r=new Float32Array(3*n);for(let s=0,i;s<n;s++)i=3*s,r[i]=e[s]||0,r[i+1]=t[s]||0,r[i+2]=o[s]||0;this.setAttribute("position",r)}setXYZRGBS(e,t,o,n,r,l,m=1){const s=n.length;let d=new Float32Array(s);for(var c=0;c<s;c++)d[c]=a.rgbToFloat(n[c],r[c],l[c]);return this._setValues(e,t,o,d,m),this}setXYZHexS(e,t,o,n,r=1){const s=e.length;let l=new Float32Array(s),c=a.hexToFloat(n);for(var m=0;m<s;m++)l[m]=c;return this._setValues(e,t,o,l,r),this}setXYZHS(e,t,o,n=1,r=1){const s=e.length;let l=new Float32Array(s);if("number"!=typeof n)for(var c=0;c<s;c++)l[c]=a.hslToFloat(n[c]);else if(typeof n){n=a.hslToFloat(n);for(var c=0;c<s;c++)l[c]=n}return this._setValues(e,t,o,l,r),this}_setValues(e,t,o,n,r){let a=this.getMaxLength(e,t,o),l=new Float32Array(a);for(var c=0;c<a;c++)l[c]=0;if("number"==typeof r){let e=new Float32Array(a);for(var c=0;c<a;c++)e[c]=r;r=e}return this.setPositionsXYZ(e,t,o),this.setHSSFromArrays(n,l,r),this.renderer.camera.updateProjectionMatrix(),this.renderer.camera.updateViewMatrix(),this}setPositionsXYZHSS(e,t,o,n,r,i){console.warn("The method \"setPositionsXYZHSS\" is marked as deprecated.");let s=this.getMaxLength(e,t,o);this.setPositionsXYZ(e,t,o,s),this.setHSS(n,r,i,s)}setColors(e){this.setAttribute("color",e)}updateColors(e){this.updateAttributeAll("color",e)}updateColor(e,t){this.updateAttribute("color",e,t.components)}setPointSize(e){e*this.opts.pointScale>this.opts.maxPointSize||(this.geometry.shader.uniforms.size.value=e*this.opts.pointScale)}getPointSize(){return this.geometry.shader.uniforms.size.value}setFogDistance(){console.warn("This function is deprecated.")}initPointSize(){this.geometry.shader.uniforms.size.value=this.renderer.camera.zoom*this.opts.pointScale}getCutoff(){return this.geometry.shader.uniforms.cutoff.value}setCutoff(e){this.geometry.shader.uniforms.cutoff.value=e}getHue(e){let t=this.getAttribute("color");return t[3*e]}setHSS(e,t,o,n){let r=new Float32Array(3*n);for(let s=0;s<3*n;s+=3)r[s]=e,r[s+1]=t,r[s+2]=o;this.setColors(r)}setFog(e,t=6){return this.geometry.shader.uniforms.clearColor&&this.geometry.shader.uniforms.fogDensity?(this.geometry.shader.uniforms.clearColor.value=e,this.geometry.shader.uniforms.fogDensity.value=t,this):(console.warn("Shader \""+this.geometry.shader.name+"\" does not support fog."),this)}setHSSFromArrays(e,t,o){let n=e.length,r=new Float32Array(3*n),s=0;if(e.length!==n&&t.length!==n&&o.length!==n)throw"Hue, saturation and size have to be arrays of length \"length\" ("+n+").";for(let a=0;a<3*n;a+=3)r[a]=e[s],r[a+1]=t[s],r[a+2]=o[s],s++;this.setColors(r)}addFilter(e,t){t.setGeometry(this.geometry),this.filters[e]=t}removeFilter(e){delete this.filters[e]}getFilter(e){return this.filters[e]}}},{"../Core/Color":11,"../Core/DrawModes":12,"../Utils/Utils":62,"./HelperBase":27}],31:[function(e,t){"use strict";const o=e("./AABBHelper"),n=e("./CoordinatesHelper"),r=e("./HelperBase"),i=e("./OctreeHelper"),s=e("./PointHelper"),a=e("./TreeHelper");t.exports={AABBHelper:o,CoordinatesHelper:n,HelperBase:r,OctreeHelper:i,PointHelper:s,TreeHelper:a}},{"./AABBHelper":25,"./CoordinatesHelper":26,"./HelperBase":27,"./OctreeHelper":28,"./PointHelper":29,"./TreeHelper":30}],32:[function(e,t){"use strict";const o=e("./FileReaderBase"),n=e("../Utils/Utils");t.exports=class extends o{constructor(e,t,o=!0){super(e,o),this.defaults={separator:",",cols:[],types:[],header:!0},this.opts=n.extend(!0,this.defaults,t),this.columns={},this.headers=[],this.types=this.opts.types,this.cols=this.opts.cols}loaded(e){e=e.replace("\n\n","\n"),e=e.replace(/^\s+|\s+$/g,"");let t=e.split("\n"),o=t.length,r=!0,s=this.opts.header?1:0;if(0!==this.cols.length){if(this.types.length!==this.cols.length)throw"Types and cols must have the same number of elements.";}else if(this.types.length!==this.cols.length||0===this.types.length+this.cols.length){let e=t[s].split(this.opts.separator);this.types=[];for(let t=0;t<e.length;t++)n.isFloat(parseFloat(e[t],10))?this.types.push("Float32Array"):n.isInt(parseFloat(e[t],10))?this.types.push("Int32Array"):this.types.push("StringArray")}if(0===this.cols.length){let e=t[0].split(this.opts.separator);for(let t=0;t<e.length;t++)this.cols.push(t)}if(s){let e=t[0].split(this.opts.separator);for(let t=0;t<this.cols.length;t++)this.headers[t]=e[this.cols[t]].trim()}else for(let e=0;e<this.cols.length;e++)this.headers[e]=e;for(let n=s,i;n<o;n++){if(i=t[n].split(this.opts.separator),0==this.cols.length)for(let e=0;e<i.length;e++)this.cols.push[e];if(r){for(let e=0;e<this.cols.length;e++)this._createArray(this.headers[e],this.types[e],o-s);r=!1}for(let e=0;e<this.cols.length;e++)this.columns[this.headers[e]][n-s]=i[this.cols[e]]}return this.raiseEvent("loaded",this.columns),this}_createArray(e,t,o){return this.columns[e]="Int8Array"==t?new Int8Array(o):"Uint8Array"==t?new Uint8Array(o):"Uint8ClampedArray"==t?new Uint8ClampedArray(o):"Int16Array"==t?new Int16Array(o):"Uint16Array"==t?new Uint16Array(o):"Int32Array"==t?new Int32Array(o):"Uint32Array"==t?new Uint32Array(o):"Float32Array"==t?new Float32Array(o):"Float64Array"==t?new Float64Array(o):Array(o),this}}},{"../Utils/Utils":62,"./FileReaderBase":33}],33:[function(e,t){"use strict";const o=e("../Utils/Utils");t.exports=class{constructor(e,t=!0){this.source=e,this._eventListeners={};let n=this;t?(this.element=document.getElementById(this.source),this.element.addEventListener("click",function(){this.value=null}),this.element.addEventListener("change",function(){let e=new FileReader;e.onload=function(){n.loaded(e.result)},e.readAsBinaryString(this.files[0])})):o.jsonp(e,function(e){n.loaded(e)})}addEventListener(e,t){this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t)}raiseEvent(e,t){if(this._eventListeners[e])for(let o=0;o<this._eventListeners[e].length;o++)this._eventListeners[e][o](t)}loaded(){}}},{"../Utils/Utils":62}],34:[function(e,t){"use strict";const o=e("./FileReaderBase"),n=e("../Utils/Utils");t.exports=class extends o{constructor(e,t,o=!0){if(super(e,o),this.defaults={elementSeperator:"\t",valueSeparator:";",replaceNaNWith:"NaN",skipNaN:!0,types:[]},this.opts=n.extend(!0,this.defaults,t),this.types=this.opts.types,this.columns={},0===this.types.length)throw"When reading data from a file, the types have to be specified.";this.opts.types.unshift("Int32Array"),this.opts.types.unshift("Int32Array"),this.opts.types.unshift("Int32Array")}loaded(e){e=e.replace("\n\n","\n"),e=e.replace(/^\s+|\s+$/g,""),"NaN"!==this.opts.replaceNaNWith&&(e=e.replace("NaN",this.opts.replaceNaNWith));let t=e.split("\n"),o=t.length,r=t[0].split(this.opts.elementSeperator).length,s=t[0].split(this.opts.elementSeperator)[0].split(this.opts.valueSeparator).length+3;if(this.types.length!==s||0===this.types.length+s){let e=t[0].split(this.opts.valueSeparator);this.types=[];for(let t=0;t<e.length;t++)n.isFloat(parseFloat(e[t],10))?this.types.push("Float32Array"):n.isInt(parseFloat(e[t],10))?this.types.push("Int32Array"):this.types.push("StringArray")}for(var a=0;a<s;a++)this._createArray(a,this.types[a],o*r);let l=0;for(var a=0;a<o;a++){let e=t[a].split(this.opts.elementSeperator);if(0!==e.length)for(var c=0;c<r;c++){if(!e[c])continue;let t=e[c].split(this.opts.valueSeparator);if(this.opts.skipNaN){let e=!1;for(var m=0;m<t.length;m++)if(isNaN(t[m])){e=!0;break}if(e)continue}this.columns[0][l]=a,this.columns[1][l]=c,this.columns[2][l]=0;for(var m=0;m<t.length;m++)this.columns[m+3][l]=t[m];l++}}return this._resizeArrays(l),this.raiseEvent("loaded",this.columns),this}_resizeArrays(e){for(var t=0;t<this.columns.length;t++)this.columns[t]=this.columns[t].slice(0,e)}_createArray(e,t,o){return this.columns[e]="Int8Array"==t?new Int8Array(o):"Uint8Array"==t?new Uint8Array(o):"Uint8ClampedArray"==t?new Uint8ClampedArray(o):"Int16Array"==t?new Int16Array(o):"Uint16Array"==t?new Uint16Array(o):"Int32Array"==t?new Int32Array(o):"Uint32Array"==t?new Uint32Array(o):"Float32Array"==t?new Float32Array(o):"Float64Array"==t?new Float64Array(o):Array(o),this}}},{"../Utils/Utils":62,"./FileReaderBase":33}],35:[function(e,t){"use strict";const o=e("./CsvFileReader"),n=e("./FileReaderBase"),r=e("./MatrixFileReader");t.exports={CsvFileReader:o,FileReaderBase:n,MatrixFileReader:r}},{"./CsvFileReader":32,"./FileReaderBase":33,"./MatrixFileReader":34}],36:[function(e,t){"use strict";const o=e("./Core"),n=e("./Controls"),r=e("./Cameras"),i=e("./Filters"),s=e("./Helpers"),a=e("./IO"),l=e("./Math"),c=e("./Shaders"),m=e("./Spice"),d=e("./Utils").Utils;t.exports={Cameras:r,Controls:n,Core:o,Filters:i,Helpers:s,IO:a,Math:l,Shaders:c,Spice:m,Utils:d}},{"./Cameras":5,"./Controls":9,"./Core":21,"./Filters":24,"./Helpers":31,"./IO":35,"./Math":46,"./Shaders":57,"./Spice":61,"./Utils":63}],37:[function(e,t){"use strict";class o{constructor(e=new Float32Array([1,0,0,0,1,0,0,0,1])){this.entries=e}clone(){return new o(new Float32Array(this.entries))}equals(e){for(let t=0;t<this.entries.length;t++)if(this.entries[t]!==e.entries[t])return!1;return!0}}t.exports=o},{}],38:[function(e,t){"use strict";var o=Math.sqrt;const n=e("./Vector3f");class r{constructor(e=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])){this.entries=e}set(e,t,o,n,r,i,s,a,l,c,m,d,p,f,u,g){return this.entries.set([e,t,o,n,r,i,s,a,l,c,m,d,p,f,u,g]),this}setZero(){return this}multiplyA(e){let t=this.entries[0],o=this.entries[4],n=this.entries[8],r=this.entries[12],i=this.entries[1],s=this.entries[5],a=this.entries[9],l=this.entries[13],c=this.entries[2],m=this.entries[6],d=this.entries[10],p=this.entries[14],f=this.entries[3],u=this.entries[7],g=this.entries[11],h=this.entries[15],x=e.entries[0],v=e.entries[4],y=e.entries[8],b=e.entries[12],P=e.entries[1],N=e.entries[5],_=e.entries[9],A=e.entries[13],S=e.entries[2],C=e.entries[6],E=e.entries[10],M=e.entries[14],T=e.entries[3],z=e.entries[7],L=e.entries[11],F=e.entries[15];return this.entries[0]=t*x+o*P+n*S+r*T,this.entries[1]=i*x+s*P+a*S+l*T,this.entries[2]=f*x+u*P+g*S+h*T,this.entries[3]=t*v+o*N+n*C+r*z,this.entries[4]=c*x+m*P+d*S+p*T,this.entries[5]=i*v+s*N+a*C+l*z,this.entries[6]=c*v+m*N+d*C+p*z,this.entries[7]=f*v+u*N+g*C+h*z,this.entries[8]=t*y+o*_+n*E+r*L,this.entries[9]=i*y+s*_+a*E+l*L,this.entries[10]=c*y+m*_+d*E+p*L,this.entries[11]=f*y+u*_+g*E+h*L,this.entries[12]=t*b+o*A+n*M+r*F,this.entries[13]=i*b+s*A+a*M+l*F,this.entries[14]=c*b+m*A+d*M+p*F,this.entries[15]=f*b+u*A+g*M+h*F,this}multiplyB(e){let t=e.entries[0],o=e.entries[4],n=e.entries[8],r=e.entries[12],i=e.entries[1],s=e.entries[5],a=e.entries[9],l=e.entries[13],c=e.entries[2],m=e.entries[6],d=e.entries[10],p=e.entries[14],f=e.entries[3],u=e.entries[7],g=e.entries[11],h=e.entries[15],x=this.entries[0],v=this.entries[4],y=this.entries[8],b=this.entries[12],P=this.entries[1],N=this.entries[5],_=this.entries[9],A=this.entries[13],S=this.entries[2],C=this.entries[6],E=this.entries[10],M=this.entries[14],T=this.entries[3],z=this.entries[7],L=this.entries[11],F=this.entries[15];return this.entries[0]=t*x+o*P+n*S+r*T,this.entries[1]=i*x+s*P+a*S+l*T,this.entries[2]=f*x+u*P+g*S+h*T,this.entries[3]=t*v+o*N+n*C+r*z,this.entries[4]=c*x+m*P+d*S+p*T,this.entries[5]=i*v+s*N+a*C+l*z,this.entries[6]=c*v+m*N+d*C+p*z,this.entries[7]=f*v+u*N+g*C+h*z,this.entries[8]=t*y+o*_+n*E+r*L,this.entries[9]=i*y+s*_+a*E+l*L,this.entries[10]=c*y+m*_+d*E+p*L,this.entries[11]=f*y+u*_+g*E+h*L,this.entries[12]=t*b+o*A+n*M+r*F,this.entries[13]=i*b+s*A+a*M+l*F,this.entries[14]=c*b+m*A+d*M+p*F,this.entries[15]=f*b+u*A+g*M+h*F,this}scale(e){let t=e.components[0],o=e.components[1],n=e.components[2];return this.entries[0]*=t,this.entries[1]*=t,this.entries[2]*=t,this.entries[3]*=t,this.entries[4]*=o,this.entries[5]*=o,this.entries[6]*=o,this.entries[7]*=o,this.entries[8]*=n,this.entries[9]*=n,this.entries[10]*=n,this.entries[11]*=n,this}setPosition(e){return this.entries[12]=e.components[0],this.entries[13]=e.components[1],this.entries[14]=e.components[2],this}setRotation(e){let t=e.components[0],o=e.components[1],n=e.components[2],r=e.components[3],i=t+t,s=o+o,a=n+n,l=t*i,c=t*s,m=t*a,d=o*s,p=o*a,f=n*a,u=r*i,g=r*s,h=r*a;return this.entries[0]=1-(d+f),this.entries[1]=c+h,this.entries[2]=m-g,this.entries[4]=c-h,this.entries[5]=1-(l+f),this.entries[6]=p+u,this.entries[8]=m+g,this.entries[9]=p-u,this.entries[10]=1-(l+d),this.entries[3]=0,this.entries[7]=0,this.entries[11]=0,this.entries[12]=0,this.entries[13]=0,this.entries[14]=0,this.entries[15]=1,this}determinant(){let e=this.entries,t=e.entries[0],o=e.entries[4],n=e.entries[8],r=e.entries[12],i=e.entries[1],s=e.entries[5],a=e.entries[9],l=e.entries[13],c=e.entries[2],m=e.entries[6],d=e.entries[10],p=e.entries[14],f=e.entries[3],u=e.entries[7],g=e.entries[11],h=e.entries[15];return f*(r*a*m-n*l*m-r*s*d+o*l*d+n*s*p-o*a*p)+u*(t*a*p-t*l*d+r*i*d-n*i*p+n*l*c-r*a*c)+g*(t*l*m-t*s*p-r*i*m+o*i*p+r*s*c-o*l*c)+h*(-n*s*c-t*a*m+t*s*d+n*i*m-o*i*d+o*a*c)}decompose(e,t,n){let i=new r;e.set(this.entries[12],this.entries[13],this.entries[14]);let s=o(this.entries[0]*this.entries[0]+this.entries[1]*this.entries[1]+this.entries[2]*this.entries[2]),a=o(this.entries[4]*this.entries[4]+this.entries[5]*this.entries[5]+this.entries[6]*this.entries[6]),l=o(this.entries[8]*this.entries[8]+this.entries[9]*this.entries[9]+this.entries[10]*this.entries[10]),c=this.determinant();0>c&&(s=-s),n.set(s,a,l);let m=1/s,d=1/a,p=1/l;return i.entries.set(this.entries),i.entries[0]*=m,i.entries[1]*=m,i.entries[2]*=m,i.entries[4]*=d,i.entries[5]*=d,i.entries[6]*=d,i.entries[8]*=p,i.entries[9]*=p,i.entries[10]*=p,t.setFromMatrix(i),this}compose(e,t,o){return this.setRotation(t),this.scale(o),this.setPosition(e),this}invert(){let e=new r,t=this.entries;e.entries[0]=t[5]*t[10]*t[15]-t[5]*t[11]*t[14]-t[9]*t[6]*t[15]+t[9]*t[7]*t[14]+t[13]*t[6]*t[11]-t[13]*t[7]*t[10],e.entries[4]=-t[4]*t[10]*t[15]+t[4]*t[11]*t[14]+t[8]*t[6]*t[15]-t[8]*t[7]*t[14]-t[12]*t[6]*t[11]+t[12]*t[7]*t[10],e.entries[8]=t[4]*t[9]*t[15]-t[4]*t[11]*t[13]-t[8]*t[5]*t[15]+t[8]*t[7]*t[13]+t[12]*t[5]*t[11]-t[12]*t[7]*t[9],e.entries[12]=-t[4]*t[9]*t[14]+t[4]*t[10]*t[13]+t[8]*t[5]*t[14]-t[8]*t[6]*t[13]-t[12]*t[5]*t[10]+t[12]*t[6]*t[9],e.entries[1]=-t[1]*t[10]*t[15]+t[1]*t[11]*t[14]+t[9]*t[2]*t[15]-t[9]*t[3]*t[14]-t[13]*t[2]*t[11]+t[13]*t[3]*t[10],e.entries[5]=t[0]*t[10]*t[15]-t[0]*t[11]*t[14]-t[8]*t[2]*t[15]+t[8]*t[3]*t[14]+t[12]*t[2]*t[11]-t[12]*t[3]*t[10],e.entries[9]=-t[0]*t[9]*t[15]+t[0]*t[11]*t[13]+t[8]*t[1]*t[15]-t[8]*t[3]*t[13]-t[12]*t[1]*t[11]+t[12]*t[3]*t[9],e.entries[13]=t[0]*t[9]*t[14]-t[0]*t[10]*t[13]-t[8]*t[1]*t[14]+t[8]*t[2]*t[13]+t[12]*t[1]*t[10]-t[12]*t[2]*t[9],e.entries[2]=t[1]*t[6]*t[15]-t[1]*t[7]*t[14]-t[5]*t[2]*t[15]+t[5]*t[3]*t[14]+t[13]*t[2]*t[7]-t[13]*t[3]*t[6],e.entries[6]=-t[0]*t[6]*t[15]+t[0]*t[7]*t[14]+t[4]*t[2]*t[15]-t[4]*t[3]*t[14]-t[12]*t[2]*t[7]+t[12]*t[3]*t[6],e.entries[10]=t[0]*t[5]*t[15]-t[0]*t[7]*t[13]-t[4]*t[1]*t[15]+t[4]*t[3]*t[13]+t[12]*t[1]*t[7]-t[12]*t[3]*t[5],e.entries[14]=-t[0]*t[5]*t[14]+t[0]*t[6]*t[13]+t[4]*t[1]*t[14]-t[4]*t[2]*t[13]-t[12]*t[1]*t[6]+t[12]*t[2]*t[5],e.entries[3]=-t[1]*t[6]*t[11]+t[1]*t[7]*t[10]+t[5]*t[2]*t[11]-t[5]*t[3]*t[10]-t[9]*t[2]*t[7]+t[9]*t[3]*t[6],e.entries[7]=t[0]*t[6]*t[11]-t[0]*t[7]*t[10]-t[4]*t[2]*t[11]+t[4]*t[3]*t[10]+t[8]*t[2]*t[7]-t[8]*t[3]*t[6],e.entries[11]=-t[0]*t[5]*t[11]+t[0]*t[7]*t[9]+t[4]*t[1]*t[11]-t[4]*t[3]*t[9]-t[8]*t[1]*t[7]+t[8]*t[3]*t[5],e.entries[15]=t[0]*t[5]*t[10]-t[0]*t[6]*t[9]-t[4]*t[1]*t[10]+t[4]*t[2]*t[9]+t[8]*t[1]*t[6]-t[8]*t[2]*t[5];let o=t[0]*e.entries[0]+t[1]*e.entries[4]+t[2]*e.entries[8]+t[3]*e.entries[12];if(0==o)throw"Determinant is zero.";o=1/o;for(let t=0;16>t;t++)this.entries[t]=e.entries[t]*o;return this}static projectVector(e,t){return e.applyProjection(r.multiply(t.projectionMatrix,r.invert(t.modelMatrix)))}static unprojectVector(e,t){return e.applyProjection(r.multiply(t.modelMatrix,r.invert(t.projectionMatrix)))}clone(){return new r(new Float32Array(this.entries))}equals(e){for(let t=0;t<this.entries.length;t++)if(this.entries[t]!==e.entries[t])return!1;return!0}toString(){let e=this.entries[0]+", "+this.entries[4]+", "+this.entries[8]+", "+this.entries[12]+"\n";return e+=this.entries[1]+", "+this.entries[5]+", "+this.entries[9]+", "+this.entries[13]+"\n",e+=this.entries[2]+", "+this.entries[6]+", "+this.entries[10]+", "+this.entries[14]+"\n",e+=this.entries[3]+", "+this.entries[7]+", "+this.entries[11]+", "+this.entries[15]+"\n",e}static multiply(e,t){let o=e.entries[0],n=e.entries[4],i=e.entries[8],s=e.entries[12],a=e.entries[1],l=e.entries[5],c=e.entries[9],m=e.entries[13],d=e.entries[2],p=e.entries[6],f=e.entries[10],u=e.entries[14],g=e.entries[3],h=e.entries[7],x=e.entries[11],v=e.entries[15],y=t.entries[0],b=t.entries[4],P=t.entries[8],N=t.entries[12],_=t.entries[1],A=t.entries[5],S=t.entries[9],C=t.entries[13],E=t.entries[2],M=t.entries[6],T=t.entries[10],z=t.entries[14],L=t.entries[3],F=t.entries[7],D=t.entries[11],U=t.entries[15];return new r(new Float32Array([o*y+n*_+i*E+s*L,a*y+l*_+c*E+m*L,d*y+p*_+f*E+u*L,g*y+h*_+x*E+v*L,o*b+n*A+i*M+s*F,a*b+l*A+c*M+m*F,d*b+p*A+f*M+u*F,g*b+h*A+x*M+v*F,o*P+n*S+i*T+s*D,a*P+l*S+c*T+m*D,d*P+p*S+f*T+u*D,g*P+h*S+x*T+v*D,o*N+n*C+i*z+s*U,a*N+l*C+c*z+m*U,d*N+p*C+f*z+u*U,g*N+h*C+x*z+v*U]))}static fromQuaternion(e){let t=e.components[0],o=e.components[1],n=e.components[2],i=e.components[3],s=t+t,a=o+o,l=n+n,c=t*s,m=t*a,d=t*l,p=o*a,f=o*l,u=n*l,g=i*s,h=i*a,x=i*l;return new r(new Float32Array([1-(p+u),m+x,d-h,0,m-x,1-(c+u),f+g,0,d+h,f-g,1-(c+p),0,0,0,0,1]))}static lookAt(e,t,o){let i=n.subtract(e,t).normalize();0===i.lengthSq()&&(i.components[2]=1);let s=n.cross(o,i).normalize();0===s.lengthSq()&&(i.components[2]+=1e-4,s=n.cross(o,i).normalize());let a=n.cross(i,s);return new r(new Float32Array([s.components[0],s.components[1],s.components[2],0,a.components[0],a.components[1],a.components[2],0,i.components[0],i.components[1],i.components[2],0,0,0,0,1]))}static compose(e,t,o){let n=new r;return n.setRotation(t),n.scale(o),n.setPosition(e),n}static invert(e){let t=new r,o=e.entries;t.entries[0]=o[5]*o[10]*o[15]-o[5]*o[11]*o[14]-o[9]*o[6]*o[15]+o[9]*o[7]*o[14]+o[13]*o[6]*o[11]-o[13]*o[7]*o[10],t.entries[4]=-o[4]*o[10]*o[15]+o[4]*o[11]*o[14]+o[8]*o[6]*o[15]-o[8]*o[7]*o[14]-o[12]*o[6]*o[11]+o[12]*o[7]*o[10],t.entries[8]=o[4]*o[9]*o[15]-o[4]*o[11]*o[13]-o[8]*o[5]*o[15]+o[8]*o[7]*o[13]+o[12]*o[5]*o[11]-o[12]*o[7]*o[9],t.entries[12]=-o[4]*o[9]*o[14]+o[4]*o[10]*o[13]+o[8]*o[5]*o[14]-o[8]*o[6]*o[13]-o[12]*o[5]*o[10]+o[12]*o[6]*o[9],t.entries[1]=-o[1]*o[10]*o[15]+o[1]*o[11]*o[14]+o[9]*o[2]*o[15]-o[9]*o[3]*o[14]-o[13]*o[2]*o[11]+o[13]*o[3]*o[10],t.entries[5]=o[0]*o[10]*o[15]-o[0]*o[11]*o[14]-o[8]*o[2]*o[15]+o[8]*o[3]*o[14]+o[12]*o[2]*o[11]-o[12]*o[3]*o[10],t.entries[9]=-o[0]*o[9]*o[15]+o[0]*o[11]*o[13]+o[8]*o[1]*o[15]-o[8]*o[3]*o[13]-o[12]*o[1]*o[11]+o[12]*o[3]*o[9],t.entries[13]=o[0]*o[9]*o[14]-o[0]*o[10]*o[13]-o[8]*o[1]*o[14]+o[8]*o[2]*o[13]+o[12]*o[1]*o[10]-o[12]*o[2]*o[9],t.entries[2]=o[1]*o[6]*o[15]-o[1]*o[7]*o[14]-o[5]*o[2]*o[15]+o[5]*o[3]*o[14]+o[13]*o[2]*o[7]-o[13]*o[3]*o[6],t.entries[6]=-o[0]*o[6]*o[15]+o[0]*o[7]*o[14]+o[4]*o[2]*o[15]-o[4]*o[3]*o[14]-o[12]*o[2]*o[7]+o[12]*o[3]*o[6],t.entries[10]=o[0]*o[5]*o[15]-o[0]*o[7]*o[13]-o[4]*o[1]*o[15]+o[4]*o[3]*o[13]+o[12]*o[1]*o[7]-o[12]*o[3]*o[5],t.entries[14]=-o[0]*o[5]*o[14]+o[0]*o[6]*o[13]+o[4]*o[1]*o[14]-o[4]*o[2]*o[13]-o[12]*o[1]*o[6]+o[12]*o[2]*o[5],t.entries[3]=-o[1]*o[6]*o[11]+o[1]*o[7]*o[10]+o[5]*o[2]*o[11]-o[5]*o[3]*o[10]-o[9]*o[2]*o[7]+o[9]*o[3]*o[6],t.entries[7]=o[0]*o[6]*o[11]-o[0]*o[7]*o[10]-o[4]*o[2]*o[11]+o[4]*o[3]*o[10]+o[8]*o[2]*o[7]-o[8]*o[3]*o[6],t.entries[11]=-o[0]*o[5]*o[11]+o[0]*o[7]*o[9]+o[4]*o[1]*o[11]-o[4]*o[3]*o[9]-o[8]*o[1]*o[7]+o[8]*o[3]*o[5],t.entries[15]=o[0]*o[5]*o[10]-o[0]*o[6]*o[9]-o[4]*o[1]*o[10]+o[4]*o[2]*o[9]+o[8]*o[1]*o[6]-o[8]*o[2]*o[5];let n=o[0]*t.entries[0]+o[1]*t.entries[4]+o[2]*t.entries[8]+o[3]*t.entries[12];if(0==n)throw"Determinant is zero.";n=1/n;for(let o=0;16>o;o++)t.entries[o]*=n;return t}}t.exports=r},{"./Vector3f":45}],39:[function(e,t){"use strict";const o=e("./Matrix4f"),n=e("../Utils/Utils");t.exports=class extends o{setOrthographic(e,t,o,n,r,i){let s=1/(t-e),a=1/(o-n),l=1/(i-r);return this.setZero(),this.entries[0]=2*s,this.entries[4]=0,this.entries[8]=0,this.entries[12]=-((t+e)*s),this.entries[1]=0,this.entries[5]=2*a,this.entries[9]=0,this.entries[13]=-((o+n)*a),this.entries[2]=0,this.entries[6]=0,this.entries[10]=-2*l,this.entries[14]=-((i+r)*l),this.entries[3]=0,this.entries[7]=0,this.entries[11]=0,this.entries[15]=1,this}setPerspective(e,t,o,r){var i=Math.tan;let s=i(.5*n.DEG2RAD*e),a=o*s,l=2*a,c=t*l,m=-c/2,d=m+c,p=a-l;return this.setZero(),this.entries[0]=2*o/(d-m),this.entries[4]=0,this.entries[8]=(d+m)/(d-m),this.entries[12]=0,this.entries[1]=0,this.entries[5]=2*o/(a-p),this.entries[9]=(a+p)/(a-p),this.entries[13]=0,this.entries[2]=0,this.entries[6]=0,this.entries[10]=-(r+o)/(r-o),this.entries[14]=-2*r*o/(r-o),this.entries[3]=0,this.entries[7]=0,this.entries[11]=-1,this.entries[15]=0,this}}},{"../Utils/Utils":62,"./Matrix4f":38}],40:[function(e,t){"use strict";var o=Math.acos,n=Math.sin,r=Math.cos,i=Math.abs,a=Math.sqrt;const l=e("./Vector3f"),c=e("./Matrix4f");class d{constructor(e,t,o,n){1===arguments.length?this.components=new Float32Array(e):2===arguments.length?(this.components=new Float32Array(4),this.setFromAxisAngle(e,t)):(this.components=new Float32Array(4),this.components[0]=e||0,this.components[1]=t||0,this.components[2]=o||0,this.components[3]=n===void 0?1:n)}getX(){return this.components[0]}getY(){return this.components[1]}getZ(){return this.components[2]}getW(){return this.components[3]}set(e,t,o,n){return this.components[0]=e,this.components[1]=t,this.components[2]=o,this.components[3]=n,this}setX(e){return this.components[0]=e,this}setY(e){return this.components[1]=e,this}setZ(e){return this.components[2]=e,this}setW(e){return this.components[3]=e,this}setFromAxisAngle(e,t){let o=l.normalize(e),i=t/2,s=n(i);return this.components[0]=o.components[0]*s,this.components[1]=o.components[1]*s,this.components[2]=o.components[2]*s,this.components[3]=r(i),this}setFromUnitVectors(e,t){let o=null,n=e.dot(t)+1;return 1e-6>n?(o=new l(0,0,0),n=0,i(e.components[0])>i(e.components[2])?o.set(-e.components[1],e.components[0],0):o.set(0,-e.components[2],e.components[1])):o=l.cross(e,t),this.set(o.components[0],o.components[1],o.components[2],n),this.normalize(),this}lookAt(e,t,o){return this.setFromMatrix(c.lookAt(e,t,o)),this}lengthSq(){return this.components[0]*this.components[0]+this.components[1]*this.components[1]+this.components[2]*this.components[2]+this.components[3]*this.components[3]}length(){return a(this.lengthSq())}inverse(){return this.conjugate().normalize()}normalize(){let e=this.length();if(0===e)this.components[0]=0,this.components[1]=0,this.components[2]=0,this.components[3]=1;else{let t=1/e;this.components[0]*=t,this.components[1]*=t,this.components[2]*=t,this.components[3]*=t}return this}dot(e){return this.components[0]*e.components[0]+this.components[1]*e.components[1]+this.components[2]*e.components[2]+this.components[3]*e.components[3]}multiplyA(e){let t=this.components[0]*e.components[3]+this.components[3]*e.components[0]+this.components[1]*e.components[2]-this.components[2]*e.components[1],o=this.components[1]*e.components[3]+this.components[3]*e.components[1]+this.components[2]*e.components[0]-this.components[0]*e.components[2],n=this.components[2]*e.components[3]+this.components[3]*e.components[2]+this.components[0]*e.components[1]-this.components[1]*e.components[0],r=this.components[3]*e.components[3]-this.components[0]*e.components[0]-this.components[1]*e.components[1]-this.components[2]*e.components[2];return this.components[0]=t,this.components[1]=o,this.components[2]=n,this.components[3]=r,this}multiplyB(e){let t=e.components[0]*this.components[3]+e.components[3]*this.components[0]+e.components[1]*this.components[2]-e.components[2]*this.components[1],o=e.components[1]*this.components[3]+e.components[3]*this.components[1]+e.components[2]*this.components[0]-e.components[0]*this.components[2],n=e.components[2]*this.components[3]+e.components[3]*this.components[2]+e.components[0]*this.components[1]-e.components[1]*this.components[0],r=e.components[3]*this.components[3]-e.components[0]*this.components[0]-e.components[1]*this.components[1]-e.components[2]*this.components[2];return this.components[0]=t,this.components[1]=o,this.components[2]=n,this.components[3]=r,this}multiplyScalar(e){return this.components[0]*=e,this.components[1]*=e,this.components[2]*=e,this.components[3]*=e,this}conjugate(){return this.components[0]*=-1,this.components[1]*=-1,this.components[2]*=-1,this}add(e){return this.components[0]+=e.components[0],this.components[1]+=e.components[1],this.components[2]+=e.components[2],this.components[3]+=e.components[3],this}subtract(e){return this.components[0]-=e.components[0],this.components[1]-=e.components[1],this.components[2]-=e.components[2],this.components[3]-=e.components[3],this}rotateX(e){let t=e/2;return this.multiplyA(new d(n(t),0,0,r(t)))}rotateY(e){let t=e/2;return this.multiplyA(new d(0,n(t),0,r(t)))}rotateZ(e){let t=e/2;return this.multiplyA(new d(0,0,n(t),r(t)))}toAxisAngle(){console.warn("The method toAxisAngle() has not been implemented.")}toRotationMatrix(){let e=this.components[0],t=this.components[1],o=this.components[2],n=this.components[3],r=e*e,i=e*o,s=e*n,a=t*n,l=t*t,m=t*o,d=o*o,p=o*n,f=new c;return f.entries[0]=1-2*(l+d),f.entries[1]=2*(e*t+p),f.entries[2]=2*(i-a),f.entries[4]=2*(m-p),f.entries[5]=1-2*(r+d),f.entries[6]=2*(m+s),f.entries[8]=2*(i+a),f.entries[9]=2*(m-s),f.entries[10]=1-2*(r+l),f}setFromMatrix(e){let o=e.entries[0],n=e.entries[4],r=e.entries[8],i=e.entries[1],l=e.entries[5],c=e.entries[9],m=e.entries[2],d=e.entries[6],p=e.entries[10],f=o+l+p;if(0<f){let e=.5/a(f+1);this.components[0]=(d-c)*e,this.components[1]=(r-m)*e,this.components[2]=(i-n)*e,this.components[3]=.25/e}else if(o>l&&o>p){let e=2*a(1+o-l-p);this.components[0]=.25*e,this.components[1]=(n+i)/e,this.components[2]=(r+m)/e,this.components[3]=(d-c)/e}else if(l>p){let e=2*a(1+l-o-p);this.components[0]=(n+i)/e,this.components[1]=.25*e,this.components[2]=(c+d)/e,this.components[3]=(r-m)/e}else{let e=2*a(1+p-o-l);this.components[0]=(r+m)/e,this.components[1]=(c+d)/e,this.components[2]=.25*e,this.components[3]=(i-n)/e}return this}clone(){return new d(this.components[0],this.components[1],this.components[2],this.components[3])}equals(e){return this.components[0]===e.components[0]&&this.components[1]===e.components[1]&&this.components[2]===e.components[2]&&this.components[3]===e.components[3]}toString(){return"x: "+this.getX()+", y: "+this.getY()+", z: "+this.getZ()+", w: "+this.getW()}static dot(e,t){return new d(e.components[0]*t.components[0]+e.components[1]*t.components[1]+e.components[2]*t.components[2]+e.components[3]*t.components[3])}static multiply(e,t){return new d(e.components[0]*t.components[3]+e.components[3]*t.components[0]+e.components[1]*t.components[2]-e.components[2]*t.components[1],e.components[1]*t.components[3]+e.components[3]*t.components[1]+e.components[2]*t.components[0]-e.components[0]*t.components[2],e.components[2]*t.components[3]+e.components[3]*t.components[2]+e.components[0]*t.components[1]-e.components[1]*t.components[0],e.components[3]*t.components[3]+e.components[0]*t.components[0]+e.components[1]*t.components[1]-e.components[2]*t.components[2])}static multiplyScalar(e,t){return new d(e.components[0]*t,e.components[1]*t,e.components[2]*t,e.components[3]*t)}static inverse(e){let t=new d(e.components);return t.conjugate().normalize()}static normalize(e){let t=e.length();if(0===t)return new d(0,0,0,1);else{let o=1/t;return new d(e.components[0]*o,e.components[1]*o,e.components[2]*o,e.components[3]*o)}}static conjugate(e){return new d(-1*e.components[0],-1*e.components[1],-1*e.components[2],e.components[3])}static add(e,t){return new d(e.components[0]+t.components[0],e.components[1]+t.components[1],e.components[2]+t.components[2],e.components[3]+t.components[3])}static subtract(e,t){return new d(e.components[0]-t.components[0],e.components[1]-t.components[1],e.components[2]-t.components[2],e.components[3]-t.components[3])}static fromMatrix(e){let t=new d;return t.setFromMatrix(e),t}static slerp(e,r,s){if(0===s)return new d(e.components);if(1===s)return new d(r.components);let t=new d(r.components),l=e.components[0]*t.components[0]+e.components[1]*t.components[1]+e.components[2]*t.components[2]+e.components[3]*t.components[3];if(0>l&&(t.multiplyScalar(-1),l=-l),1<=i(l))return new d(e.components);let c=o(l),m=a(1-l*l);if(.001>i(m))return new d(.5*e.components[0]+.5*t.components[0],.5*e.components[1]+.5*t.components[1],.5*e.components[2]+.5*t.components[2],.5*e.components[3]+.5*t.components[3]);let p=n((1-s)*c)/m,f=n(s*c)/m;return new d(e.components[0]*p+t.components[0]*f,e.components[1]*p+t.components[1]*f,e.components[2]*p+t.components[2]*f,e.components[3]*p+t.components[3]*f)}}t.exports=d},{"./Matrix4f":38,"./Vector3f":45}],41:[function(e,t){"use strict";t.exports=class{constructor(){this.max=void 0,this.mask=void 0,this.histograms=void 0,this.indices=void 0,this.tmpIndices=void 0}sort(e,t=!1){var o=Math.ceil;let r=null;t?(r=new e.constructor(e.length),r.set(e)):r=e,this.max=2048,this.mask=this.max-1,this.histograms=new Int32Array(this.max*o(64/11));let i=new Int32Array(r.buffer,r.byteOffset,r.byteLength>>2),s=o(8*r.BYTES_PER_ELEMENT/11),a=this.max*(s-1),l=1<<(8*r.BYTES_PER_ELEMENT-1)%11,c=null,m=new i.constructor(i.length);this.indices=new Uint32Array(i.length),this.tmpIndices=new Uint32Array(i.length);let d=new Uint32Array(i.length),p=this.max*s;for(let o=0;o<p;o++)this.histograms[o]=0;this.initHistograms(i,a,(l<<1)-1);for(let o=0,n;o<=a;o+=this.max){n=0;for(let e=o,t;e<o+this.max;e++)t=this.histograms[e]+n,this.histograms[e]=n-1,n=t}return this.lsbPass(i,m),c=m,m=i,i=c,this.pass(i,m),c=m,m=i,i=c,this.msbPass(i,m,l),{array:new Float32Array(m.buffer,m.byteOffset,r.length),indices:this.indices}}lsbPass(e,t){for(let o=0,r=e.length;o<r;o++){let n=e[o],r=n>>31;n^=2147483648|r;let i=++this.histograms[n&this.mask];this.indices[i]=o,t[i]=n}}pass(e,t){let o=e.length;for(let n=0;n<o;n++){let o=e[n],r=++this.histograms[this.max+(o>>>11&this.mask)];this.tmpIndices[r]=this.indices[n],t[r]=o}this.indices.set(this.tmpIndices)}msbPass(e,t,o){let r=e.length,n=2*this.max;for(let s=0;s<r;s++){let r=e[s],i=++this.histograms[n+(r>>>22&(o<<1)-1)];this.tmpIndices[i]=this.indices[s],t[i]=r^(2147483648|~(r>>31))}this.indices.set(this.tmpIndices)}initHistograms(e,t,o){let r=e.length;for(let n=0;n<r;n++){let r=e[n],i=r>>31;r^=2147483648|i;let s=0,a=0;for(;s<t;s+=this.max,a+=11)this.histograms[s+(r>>>a&this.mask)]++;this.histograms[s+(r>>>a&o)]++}}}},{}],42:[function(e,t){"use strict";const o=e("./Vector3f"),n=e("./ProjectionMatrix"),r=e("./Matrix4f");t.exports=class{constructor(e=new o(0,0,0),t=new o(0,0,0)){this.source=e,this.direction=t}copyFrom(e){return this.source.copyFrom(e.source),this.direction.copyFrom(e.direction),this}applyProjection(e){return this.direction.add(this.source).applyProjection(e),this.source.applyProjection(e),this.direction.subtract(this.source),this.direction.normalize(),this}distanceSqToPoint(e){let t=o.subtract(e,this.source),n=t.dot(this.direction);return 0>n?this.source.distanceToSq(e):(t.copyFrom(this.direction).multiplyScalar(n).add(this.source),t.distanceToSq(e))}closestPointToPoint(e){let t=o.subtract(e,this.source),n=t.dot(this.direction);return 0>n?t.copyFrom(this.source):t.copyFrom(this.direction).multiplyScalar(n).add(this.source)}}},{"./Matrix4f":38,"./ProjectionMatrix":39,"./Vector3f":45}],43:[function(e,t){"use strict";var o=Math.acos,n=Math.min,r=Math.max,i=Math.PI;e("./Vector3f");class s{constructor(e=1,t=0,o=0){this.components=new Float32Array(3),this.radius=e,this.phi=t,this.theta=o}set(e,t,o){return this.components[0]=e,this.components[1]=t,this.components[2]=o,this}secure(){return this.components[1]=r(1e-6,n(i-1e-6,this.components[1])),this}setFromVector(e){var t=Math.atan2;return this.components[0]=e.length(),0===this.components[0]?(this.components[1]=0,this.components[2]=0):(this.components[1]=o(r(-1,n(1,e.components[1]/this.components[0]))),this.components[2]=t(e.components[0],e.components[2])),this}limit(e,t,o,i){return this.components[1]=r(e,n(t,this.components[1])),this.components[2]=r(o,n(i,this.components[2])),this}clone(){return new s(this.radius,this.phi,this.theta)}toString(){return"("+this.components[0]+", "+this.components[1]+", "+this.components[2]+")"}}t.exports=s},{"./Vector3f":45}],44:[function(e,t){"use strict";var o=Math.floor;class n{static transpose2dArray(e){return e[0].map((t,o)=>e.map(e=>e[o]))}static randomNormal(){let e,t,o,r,i;if(null!==n.spareRandomNormal)e=n.spareRandomNormal,n.spareRandomNormal=null;else{do t=2*Math.random()-1,o=2*Math.random()-1,r=t*t+o*o;while(0===r||1<=r);i=Math.sqrt(-2*Math.log(r)/r),e=t*i,n.spareRandomNormal=o*i}return e/14}static randomNormalInRange(e,t){let o;do o=n.randomNormal();while(o<e||o>t);return o}static randomNormalScaled(e,t){let o=n.randomNormalInRange(-1,1);return o*t+e}static normalize(e){let t=e.slice(),o=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;for(let r=0,i;r<t.length;r++)i=t[r],i>o&&(o=i),i<n&&(n=i);let r=o-n;for(let o=0;o<t.length;o++)t[o]=(t[o]-n)/r;return t}static normalizeNoOutliers(e,t=.25,o=.75,r=1.5){let s=e.slice();s.sort((e,t)=>e-t);let l=n.getPercentile(s,t),i=n.getPercentile(s,o),a=i-l,c=l-a*r,m=i+a*r;for(let n=0;n<e.length;n++)s[n]=e[n]<c?0:e[n]>m?1:(e[n]-c)/(m-c);return s}static getPercentile(e,t){let n=t*e.length;return o(n)===n?(e[n-1]+e[n])/2:e[o(n)]}static scale(e,t,o,n,r){return(r-n)*(e-t)/(o-t)+n}}n.spareRandomNormal=null,t.exports=n},{}],45:[function(e,t){"use strict";var o=Math.sin,n=Math.cos,r=Math.sqrt;e("./SphericalCoords");class i{constructor(e,t,o){1===arguments.length?this.components=new Float32Array(e):(this.components=new Float32Array(3),this.components[0]=e||0,this.components[1]=t||0,this.components[2]=o||0)}set(e,t,o){return this.components[0]=e,this.components[1]=t,this.components[2]=o,this}getX(){return this.components[0]}getY(){return this.components[1]}getZ(){return this.components[2]}setX(e){return this.components[0]=e,this}setY(e){return this.components[1]=e,this}setZ(e){return this.components[2]=e,this}setFromSphericalCoords(e){var r=e.components[0],i=e.components[1],s=e.components[2],a=o(i)*r;return this.components[0]=o(s)*a,this.components[1]=n(i)*r,this.components[2]=n(s)*a,this}copyFrom(e){return this.components[0]=e.components[0],this.components[1]=e.components[1],this.components[2]=e.components[2],this}setLength(e){return this.multiplyScalar(e/this.length())}lengthSq(){return this.components[0]*this.components[0]+this.components[1]*this.components[1]+this.components[2]*this.components[2]}length(){return r(this.lengthSq())}normalize(){return this.divideScalar(this.length())}multiply(e){return this.components[0]*=e.components[0],this.components[1]*=e.components[1],this.components[2]*=e.components[2],this}multiplyScalar(e){return this.components[0]*=e,this.components[1]*=e,this.components[2]*=e,this}divide(e){return this.components[0]/=e.components[0],this.components[1]/=e.components[1],this.components[2]/=e.components[2],this}divideScalar(e){return this.components[0]/=e,this.components[1]/=e,this.components[2]/=e,this}add(e){return this.components[0]+=e.components[0],this.components[1]+=e.components[1],this.components[2]+=e.components[2],this}subtract(e){return this.components[0]-=e.components[0],this.components[1]-=e.components[1],this.components[2]-=e.components[2],this}dot(e){return this.components[0]*e.components[0]+this.components[1]*e.components[1]+this.components[2]*e.components[2]}cross(e){return new i(this.components[1]*e.components[2]-this.components[2]*e.components[1],this.components[2]*e.components[0]-this.components[0]*e.components[2],this.components[0]*e.components[1]-this.components[1]*e.components[0])}applyProjection(t){var o=this.components[0],n=this.components[1],r=this.components[2],i=t.entries,e=1/(i[3]*o+i[7]*n+i[11]*r+i[15]);return this.components[0]=(i[0]*o+i[4]*n+i[8]*r+i[12])*e,this.components[1]=(i[1]*o+i[5]*n+i[9]*r+i[13])*e,this.components[2]=(i[2]*o+i[6]*n+i[10]*r+i[14])*e,this}toDirection(t){var o=this.components[0],n=this.components[1],r=this.components[2],i=t.entries;return this.components[0]=i[0]*o+i[4]*n+i[8]*r,this.components[1]=i[1]*o+i[5]*n+i[9]*r,this.components[2]=i[2]*o+i[6]*n+i[10]*r,this.normalize(),this}applyQuaternion(e){var t=this.components[0],o=this.components[1],n=this.components[2],r=e.components[0],i=e.components[1],s=e.components[2],a=e.components[3],l=a*t+i*n-s*o,c=a*o+s*t-r*n,m=a*n+r*o-i*t,d=-r*t-i*o-s*n;return this.components[0]=l*a+d*-r+c*-s-m*-i,this.components[1]=c*a+d*-i+m*-r-l*-s,this.components[2]=m*a+d*-s+l*-i-c*-r,this}distanceToSq(e){var t=this.components[0]-e.components[0],o=this.components[1]-e.components[1],n=this.components[2]-e.components[2];return t*t+o*o+n*n}distanceTo(e){return r(this.distanceToSq(e))}clone(){return new i(this.components[0],this.components[1],this.components[2])}equals(e){return this.components[0]===e.components[0]&&this.components[1]===e.components[1]&&this.components[2]===e.components[2]}toString(){return"("+this.components[0]+", "+this.components[1]+", "+this.components[2]+")"}static normalize(e){return i.divideScalar(e,e.length())}static multiply(e,t){return new i(e.components[0]*t.components[0],e.components[1]*t.components[1],e.components[2]*t.components[2])}static multiplyScalar(e,t){return new i(e.components[0]*t,e.components[1]*t,e.components[2]*t)}static divide(e,t){return new i(e.components[0]/t.components[0],e.components[1]/t.components[1],e.components[2]/t.components[2])}static divideScalar(e,t){return new i(e.components[0]/t,e.components[1]/t,e.components[2]/t)}static add(e,t){return new i(e.components[0]+t.components[0],e.components[1]+t.components[1],e.components[2]+t.components[2])}static subtract(e,t){return new i(e.components[0]-t.components[0],e.components[1]-t.components[1],e.components[2]-t.components[2])}static cross(e,t){return new i(e.components[1]*t.components[2]-e.components[2]*t.components[1],e.components[2]*t.components[0]-e.components[0]*t.components[2],e.components[0]*t.components[1]-e.components[1]*t.components[0])}static dot(e,t){return e.components[0]*t.components[0]+e.components[1]*t.components[1]+e.components[2]*t.components[2]}static forward(){return new i(0,0,1)}static up(){return new i(0,1,0)}static right(){return new i(1,0,0)}}t.exports=i},{"./SphericalCoords":43}],46:[function(e,t){"use strict";const o=e("./Matrix3f"),n=e("./Matrix4f"),r=e("./ProjectionMatrix"),i=e("./Quaternion"),s=e("./RadixSort"),a=e("./Ray"),l=e("./SphericalCoords"),c=e("./Statistics"),m=e("./Vector3f");t.exports={Matrix3f:o,Matrix4f:n,ProjectionMatrix:r,Quaternion:i,RadixSort:s,Ray:a,SphericalCoords:l,Statistics:c,Vector3f:m}},{"./Matrix3f":37,"./Matrix4f":38,"./ProjectionMatrix":39,"./Quaternion":40,"./RadixSort":41,"./Ray":42,"./SphericalCoords":43,"./Statistics":44,"./Vector3f":45}],47:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("circle",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4"),fogDensity:new n("fogDensity",6,"float")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 floatToRgb(float n) {","float b = floor(n / 65536.0);","float g = floor((n - b * 65536.0) / 256.0);","float r = floor(n - b * 65536.0 - g * 256.0);","return vec3(r / 255.0, g / 255.0, b / 255.0);","}","void main() {","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0 || mv_pos.z > 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = floatToRgb(color.r);","}"],["uniform vec4 clearColor;","uniform float fogDensity;","varying vec3 vColor;","varying float vDiscard;","float rand(vec2 co) {","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(vDiscard > 0.5) discard;","vec3 N;","N.xy = gl_PointCoord * 2.0 - vec2(1.0);","float mag = dot(N.xy, N.xy);","if (mag > 1.0) discard;   // discard fragments outside circle","float z = gl_FragCoord.z / gl_FragCoord.w;","float fog_factor = clamp(exp2(-fogDensity * fogDensity * z * z * 1.442695), 0.025, 1.0);","gl_FragColor = mix(clearColor, vec4(vColor, 1.0), fog_factor);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],48:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("coordinates",1,{},["attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","gl_PointSize = 1.0;","vColor = color;","}"],["varying vec3 vColor;","void main() {","gl_FragColor = vec4(vColor, 1.0);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],49:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("default",1,{size:new n("size",5,"float"),type:new n("type",0,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4"),fogDensity:new n("fogDensity",6,"float")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 floatToRgb(float n) {","float b = floor(n / 65536.0);","float g = floor((n - b * 65536.0) / 256.0);","float r = floor(n - b * 65536.0 - g * 256.0);","return vec3(r / 255.0, g / 255.0, b / 255.0);","}","float rand(vec2 co) {","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = floatToRgb(color.r);","}"],["uniform vec4 clearColor;","uniform float fogDensity;","varying vec3 vColor;","varying float vDiscard;","void main() {","if(vDiscard > 0.5) discard;","float z = gl_FragCoord.z / gl_FragCoord.w;","float fog_factor = clamp(exp2(-fogDensity * fogDensity * z * z * 1.442695), 0.025, 1.0);","gl_FragColor = mix(clearColor, vec4(vColor, 1.0), fog_factor);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],50:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("defaultAnimated",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),time:new n("time",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4"),fogDensity:new n("fogDensity",6,"float")},["uniform float size;","uniform float cutoff;","uniform float time;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","vec3 hsv = vec3(color.r, color.g, 1.0);","float saturation = color.g;","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = size;","hsv.g *= max(0.15, abs(sin(time * 0.002)));","vColor = hsv2rgb(hsv);","}"],["uniform vec4 clearColor;","uniform float fogDensity;","varying vec3 vColor;","varying float vDiscard;","void main() {","if(vDiscard > 0.5) discard;","float z = gl_FragCoord.z / gl_FragCoord.w;","float fog_factor = clamp(exp2(-fogDensity * fogDensity * z * z * 1.442695), 0.025, 1.0);","gl_FragColor = mix(clearColor, vec4(vColor, 1.0), fog_factor);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],51:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("defaultEffect",1,{},["attribute vec2 v_coord;","uniform sampler2D fbo_texture;","varying vec2 f_texcoord;","void main() {","gl_Position = vec4(v_coord, 0.0, 1.0);","f_texcoord = (v_coord + 1.0) / 2.0;","}"],["uniform sampler2D fbo_texture;","varying vec2 f_texcoord;","void main(void) {","vec4 color = texture2D(fbo_texture, f_texcoord);","gl_FragColor = color;","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],52:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("FXAAEffect",1,{resolution:new n("resolution",[500,500],"float_vec2")},["attribute vec2 v_coord;","uniform sampler2D fbo_texture;","uniform vec2 resolution;","varying vec2 f_texcoord;","void main() {","gl_Position = vec4(v_coord, 0.0, 1.0);","f_texcoord = (v_coord + 1.0) / 2.0;","}"],["#define fxaaTexture2D(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#define fxaaSat(x) clamp(x, 0.0, 1.0)","#define FXAA_QUALITY_PS 8","#define FXAA_QUALITY_P0 1.0","#define FXAA_QUALITY_P1 1.5","#define FXAA_QUALITY_P2 2.0","#define FXAA_QUALITY_P3 2.0","#define FXAA_QUALITY_P4 2.0","#define FXAA_QUALITY_P5 2.0","#define FXAA_QUALITY_P6 4.0","#define FXAA_QUALITY_P7 12.0","vec4 fxaa(vec2 pos, sampler2D tex, vec2 resolution,","float subpixQuality, float edgeThreshold, float edgeThresholdMin) {","vec2 posM;","posM.x = pos.x;","posM.y = pos.y;","vec4 rgbyM = texture2D(tex, posM);","vec3 luma = vec3(0.299, 0.587, 0.114);","float lumaM = dot(rgbyM.xyz, luma);","float lumaS = dot(fxaaTexture2D(tex, posM, vec2(0, 1), resolution.xy).xyz, luma);","float lumaE = dot(fxaaTexture2D(tex, posM, vec2(1, 0), resolution.xy).xyz, luma);","float lumaN = dot(fxaaTexture2D(tex, posM, vec2(0, -1), resolution.xy).xyz, luma);","float lumaW = dot(fxaaTexture2D(tex, posM, vec2(-1, 0), resolution.xy).xyz, luma);","float maxSM = max(lumaS, lumaM);","float minSM = min(lumaS, lumaM);","float maxESM = max(lumaE, maxSM);","float minESM = min(lumaE, minSM);","float maxWN = max(lumaN, lumaW);","float minWN = min(lumaN, lumaW);","float rangeMax = max(maxWN, maxESM);","float rangeMin = min(minWN, minESM);","float rangeMaxScaled = rangeMax * edgeThreshold;","float range = rangeMax - rangeMin;","float rangeMaxClamped = max(edgeThresholdMin, rangeMaxScaled);","bool earlyExit = range < rangeMaxClamped;","// maybe return rgbyM -> leave unchanged","if(earlyExit) return rgbyM;","float lumaNW = dot(fxaaTexture2D(tex, posM, vec2(-1, -1), resolution.xy).xyz, luma);","float lumaSE = dot(fxaaTexture2D(tex, posM, vec2(1, 1), resolution.xy).xyz, luma);","float lumaNE = dot(fxaaTexture2D(tex, posM, vec2(1, -1), resolution.xy).xyz, luma);","float lumaSW = dot(fxaaTexture2D(tex, posM, vec2(-1, 1), resolution.xy).xyz, luma);","float lumaNS = lumaN + lumaS;","float lumaWE = lumaW + lumaE;","float subpixRcpRange = 1.0 / range;","float subpixNSWE = lumaNS + lumaWE;","float edgeHorz1 = (-2.0 * lumaM) + lumaNS;","float edgeVert1 = (-2.0 * lumaM) + lumaWE;","float lumaNESE = lumaNE + lumaSE;","float lumaNWNE = lumaNW + lumaNE;","float edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","float edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","float lumaNWSW = lumaNW + lumaSW;","float lumaSWSE = lumaSW + lumaSE;","float edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","float edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","float edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","float edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","float edgeHorz = abs(edgeHorz3) + edgeHorz4;","float edgeVert = abs(edgeVert3) + edgeVert4;","float subpixNWSWNESE = lumaNWSW + lumaNESE;","float lengthSign = resolution.x;","bool horzSpan = edgeHorz >= edgeVert;","float subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","if(!horzSpan) lumaN = lumaW;","if(!horzSpan) lumaS = lumaE;","if(horzSpan) lengthSign = resolution.y;","float subpixB = (subpixA * (1.0/12.0)) - lumaM;","float gradientN = lumaN - lumaM;","float gradientS = lumaS - lumaM;","float lumaNN = lumaN + lumaM;","float lumaSS = lumaS + lumaM;","bool pairN = abs(gradientN) >= abs(gradientS);","float gradient = max(abs(gradientN), abs(gradientS));","if(pairN) lengthSign = -lengthSign;","float subpixC = fxaaSat(abs(subpixB) * subpixRcpRange);","vec2 posB;","posB.x = posM.x;","posB.y = posM.y;","vec2 offNP;","offNP.x = (!horzSpan) ? 0.0 : resolution.x;","offNP.y = ( horzSpan) ? 0.0 : resolution.y;","if(!horzSpan) posB.x += lengthSign * 0.5;","if( horzSpan) posB.y += lengthSign * 0.5;","vec2 posN;","posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","vec2 posP;","posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","float subpixD = ((-2.0)*subpixC) + 3.0;","float lumaEndN = texture2D(tex, posN).w;","float subpixE = subpixC * subpixC;","float lumaEndP = texture2D(tex, posP).w;","if(!pairN) lumaNN = lumaSS;","float gradientScaled = gradient * 1.0/4.0;","float lumaMM = lumaM - lumaNN * 0.5;","float subpixF = subpixD * subpixE;","bool lumaMLTZero = lumaMM < 0.0;","lumaEndN -= lumaNN * 0.5;","lumaEndP -= lumaNN * 0.5;","bool doneN = abs(lumaEndN) >= gradientScaled;","bool doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","bool doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","#if (FXAA_QUALITY_PS > 3)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","#if (FXAA_QUALITY_PS > 4)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","#if (FXAA_QUALITY_PS > 5)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","#if (FXAA_QUALITY_PS > 6)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","#if (FXAA_QUALITY_PS > 7)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","#if (FXAA_QUALITY_PS > 8)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","#if (FXAA_QUALITY_PS > 9)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","#if (FXAA_QUALITY_PS > 10)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","#if (FXAA_QUALITY_PS > 11)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","#if (FXAA_QUALITY_PS > 12)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","float dstN = posM.x - posN.x;","float dstP = posP.x - posM.x;","if(!horzSpan) dstN = posM.y - posN.y;","if(!horzSpan) dstP = posP.y - posM.y;","bool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","float spanLength = (dstP + dstN);","bool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","float spanLengthRcp = 1.0 / spanLength;","bool directionN = dstN < dstP;","float dst = min(dstN, dstP);","bool goodSpan = directionN ? goodSpanN : goodSpanP;","float subpixG = subpixF * subpixF;","float pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","float subpixH = subpixG * subpixQuality;","float pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","float pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","// maybe return vec4(texture2D(tex, posM).xyz, lumaM);","return texture2D(tex, posM);","}","uniform sampler2D fbo_texture;","uniform vec2 resolution;","varying vec2 f_texcoord;","void main(void) {","gl_FragColor = fxaa(f_texcoord, fbo_texture, vec2(1.0 / resolution.x, 1.0 / resolution.y), 0.75, 0.166, 0.0833);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],53:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("simpleSphere",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4"),fogDensity:new n("fogDensity",6,"float")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 floatToRgb(float n) {","float b = floor(n / 65536.0);","float g = floor((n - b * 65536.0) / 256.0);","float r = floor(n - b * 65536.0 - g * 256.0);","return vec3(r / 255.0, g / 255.0, b / 255.0);","}","void main() {","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0 || mv_pos.z > 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = floatToRgb(color.r);","}"],["uniform vec4 clearColor;","uniform float fogDensity;","varying vec3 vColor;","varying float vDiscard;","float rand(vec2 co) {","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(vDiscard > 0.5) discard;","vec3 N;","N.xy = gl_PointCoord * 2.0 - vec2(1.0);","float mag = dot(N.xy, N.xy);","if (mag > 1.0) discard;   // discard fragments outside circle","N.z = sqrt(1.0 - mag);","vec3 light_dir = vec3(0.25, -0.25, 1.0);","float diffuse = max(0.25, dot(light_dir, N));","float z = gl_FragCoord.z / gl_FragCoord.w;","float fog_factor = clamp(exp2(-fogDensity * fogDensity * z * z * 1.442695), 0.025, 1.0);","vec3 color = vColor * diffuse;","gl_FragColor = mix(clearColor, vec4(color, 1.0), fog_factor);","}"],"circle")},{"../Core/Shader":18,"../Core/Uniform":20}],54:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("smoothCircle",2,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4"),fogDensity:new n("fogDensity",6,"float")},["uniform float size;","uniform float cutoff;","in vec3 position;","in vec3 color;","out vec3 vColor;","out float vDiscard;","vec3 floatToRgb(float n) {","float b = floor(n / 65536.0);","float g = floor((n - b * 65536.0) / 256.0);","float r = floor(n - b * 65536.0 - g * 256.0);","return vec3(r / 255.0, g / 255.0, b / 255.0);","}","void main() {","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0 || mv_pos.z > 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = floatToRgb(color.r);","}"],["uniform vec4 clearColor;","uniform float fogDensity;","in vec3 vColor;","in float vDiscard;","out vec4 fragColor;","void main() {","if(vDiscard > 0.5) discard;","float dist = distance(gl_PointCoord, vec2(0.5)) * 1.25;","float delta = fwidth(dist);","float a = 1.0 - smoothstep(0.5 - delta, 0.5 + delta, dist);","fragColor = vec4(vColor, a);","if (fogDensity > 0.0) {","float z = gl_FragCoord.z / gl_FragCoord.w;","float fog_factor = clamp(exp2(-fogDensity * fogDensity * z * z * 1.442695), 0.025, 1.0);","fragColor = mix(vec4(clearColor.rgb, a), fragColor, fog_factor);","}","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],55:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("sphere",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[0,0,0,0],"float_vec4"),fogDensity:new n("fogDensity",6,"float")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 floatToRgb(float n) {","float b = floor(n / 65536.0);","float g = floor((n - b * 65536.0) / 256.0);","float r = floor(n - b * 65536.0 - g * 256.0);","return vec3(r / 255.0, g / 255.0, b / 255.0);","}","void main() {","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0 || mv_pos.z > 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = floatToRgb(color.r);","}"],["uniform vec4 clearColor;","uniform float fogDensity;","varying vec3 vColor;","varying float vDiscard;","float rand(vec2 co) {","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(vDiscard > 0.5) discard;","vec3 N;","N.xy = gl_PointCoord * 2.0 - vec2(1.0);","float mag = dot(N.xy, N.xy);","if (mag > 1.0) discard;   // discard fragments outside circle","N.z = sqrt(1.0 - mag);","vec3 light_dir = vec3(0.25, -0.25, 1.0);","float diffuse = max(0.25, dot(light_dir, N));","vec3 v = normalize(vec3(0.1, -0.2, 1.0));","vec3 h = normalize(light_dir + v);","float specular = pow(max(0.0, dot(N, h)), 100.0);","// specular += 0.1 * rand(gl_PointCoord);","float z = gl_FragCoord.z / gl_FragCoord.w;","float fog_factor = clamp(exp2(-fogDensity * fogDensity * z * z * 1.442695), 0.025, 1.0);","vec3 color = vColor * diffuse + specular * 0.5;","gl_FragColor = mix(clearColor, vec4(color, 1.0), fog_factor);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],56:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("tree",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4"),fogDensity:new n("fogDensity",6,"float")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 floatToRgb(float n) {","float b = floor(n / 65536.0);","float g = floor((n - b * 65536.0) / 256.0);","float r = floor(n - b * 65536.0 - g * 256.0);","return vec3(r / 255.0, g / 255.0, b / 255.0);","}","void main() {","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0) {","vDiscard = 1.0;","return;","}","vColor = floatToRgb(color.r);","}"],["uniform vec4 clearColor;","uniform float fogDensity;","varying vec3 vColor;","varying float vDiscard;","void main() {","if(vDiscard > 0.5) discard;","float z = gl_FragCoord.z / gl_FragCoord.w;","float fog_factor = clamp(exp2(-fogDensity * fogDensity * z * z * 1.442695), 0.025, 1.0);","gl_FragColor = mix(clearColor, vec4(vColor, 1.0), fog_factor);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],57:[function(e,t){"use strict";var o=e("./Circle"),n=e("./Coordinates"),r=e("./Default"),i=e("./DefaultAnimated"),s=e("./DefaultEffect"),a=e("./SimpleSphere"),l=e("./SmoothCircle"),c=e("./Sphere"),m=e("./Tree"),d=e("./FXAAEffect");t.exports={circle:o,coordinates:n,defaultSquare:r,defaultAnimated:i,defaultEffect:s,simpleSphere:a,smoothCircle:l,sphere:c,tree:m,fxaaEffect:d}},{"./Circle":47,"./Coordinates":48,"./Default":49,"./DefaultAnimated":50,"./DefaultEffect":51,"./FXAAEffect":52,"./SimpleSphere":53,"./SmoothCircle":54,"./Sphere":55,"./Tree":56}],58:[function(e,t){"use strict";var o=Math.min,n=Math.max,r=Math.pow;const s=e("../Math/Vector3f");class a{constructor(e,t){this.center=e||new s(0,0,0),this.radius=t||0,this.locCode=0,this.left=0,this.right=0,this.back=0,this.front=0,this.bottom=0,this.top=0,this.neighbours=[,,,,,,],this.min=new Float32Array(3),this.max=new Float32Array(3),this.updateDimensions()}updateDimensions(){let e=this.center.components[0],t=this.center.components[1],o=this.center.components[2];return this.min[0]=e-this.radius,this.min[1]=t-this.radius,this.min[2]=o-this.radius,this.max[0]=e+this.radius,this.max[1]=t+this.radius,this.max[2]=o+this.radius,this.left=e-this.radius,this.right=e+this.radius,this.back=o-this.radius,this.front=o+this.radius,this.bottom=t-this.radius,this.top=t+this.radius,this}setLocCode(e){return this.locCode=e,this}getLocCode(){return this.locCode}rayTest(e,t,r){let i=e.components,s=t.components,a=(this.left-i[0])*s[0],l=(this.right-i[0])*s[0],c=(this.bottom-i[1])*s[1],m=(this.top-i[1])*s[1],d=(this.back-i[2])*s[2],p=(this.front-i[2])*s[2],f=o(n(a,l),n(c,m),n(d,p));if(0>f)return!1;let u=n(o(a,l),o(c,m),o(d,p));return!(u>f||u>r)}cylinderTest(e,t,o,n){this.radius+=n,this.updateDimensions();let r=this.rayTest(e,t,o);return this.radius-=n,this.updateDimensions(),r}distanceToPointSq(e,t,o){let n=0,s=[e,t,o];for(var a=0;3>a;a++)s[a]<this.min[a]&&(n+=r(this.min[a]-s[a],2)),s[a]>this.max[a]&&(n+=r(s[a]-this.max[a],2));return n}distanceFromCenterToPointSq(e,t,o){let n=this.center.components;return r(n[0]-e,2)+r(n[1]-t,2)+r(n[2]-o,2)}testAABB(e){for(var t=0;3>t;t++)if(this.max[t]<e.min[t]||this.min[t]>e.max[t])return!1;return!0}static fromPoints(e){let t=e[0],o=e[1],r=e[2],l=new s(t,o,r),c=new s(t,o,r),m=l.components,d=c.components;for(var p=1;p<e.length/3;p++)e[3*p+0]<m[0]&&(m[0]=e[3*p+0]),e[3*p+1]<m[1]&&(m[1]=e[3*p+1]),e[3*p+2]<m[2]&&(m[2]=e[3*p+2]),e[3*p+0]>d[0]&&(d[0]=e[3*p+0]),e[3*p+1]>d[1]&&(d[1]=e[3*p+1]),e[3*p+2]>d[2]&&(d[2]=e[3*p+2]);let f=s.subtract(c,l);f.multiplyScalar(.5);let u=f.components[0],g=f.components[1],h=f.components[2],x=new s(u,g,h);x.add(l);let v=n(u,g,h);return new a(x,v)}static getCorners(e){let t=e.center.components,o=t[0],n=t[1],i=t[2],s=e.radius;return[[o-s,n-s,i-s],[o-s,n-s,i+s],[o-s,n+s,i-s],[o-s,n+s,i+s],[o+s,n-s,i-s],[o+s,n-s,i+s],[o+s,n+s,i-s],[o+s,n+s,i+s]]}static clone(e){let t=new a;return t.back=e.back,t.bottom=e.bottom,t.center=new s(e.center.components[0],e.center.components[1],e.center.components[2]),t.front=e.front,t.left=e.left,t.locCode=e.locCode,t.max=e.max,t.min=e.min,t.radius=e.radius,t.right=e.right,t.top=e.top,t}}t.exports=a},{"../Math/Vector3f":45}],59:[function(e,t){"use strict";var o=Number.MIN_VALUE,n=Number.MAX_VALUE,r=Math.pow;const s=e("./AABB"),a=e("../Math/Vector3f"),l=e("../Math/ProjectionMatrix"),m=e("../Utils/Utils"),d=e("./Raycaster"),f=e("../Math/RadixSort");class u{constructor(e,t){this.threshold=e||500,this.maxDepth=t||8,this.points={},this.aabbs={},this.offsets=[[-.5,-.5,-.5],[-.5,-.5,+.5],[-.5,+.5,-.5],[-.5,+.5,+.5],[+.5,-.5,-.5],[+.5,-.5,+.5],[+.5,+.5,-.5],[+.5,+.5,+.5]]}build(e,t,n,r=1){n.setLocCode(r),this.points[r]=null,this.aabbs[r]=n;let l=this.getDepth(r);if(e.length<=this.threshold||l>=this.maxDepth){this.points[r]=new Uint32Array(e.length);for(var c=0;c<e.length;c++)this.points[r][c]=e[c];return!0}let m=new Uint32Array(8),d=new Float32Array(e.length);for(var c=0;c<e.length;c++){let o=3*e[c];t[o+0]>=n.center.components[0]&&(d[c]|=4),t[o+1]>=n.center.components[1]&&(d[c]|=2),t[o+2]>=n.center.components[2]&&(d[c]|=1),m[d[c]]++}let p=Array(8),f=Array(8);for(var c=0;8>c;c++){if(0==m[c])continue;p[c]=new Uint32Array(m[c]);for(var u=0,o=0;u<e.length;u++)d[u]==c&&(p[c][o++]=e[u]);let t=this.offsets[c],r=new a(t[0],t[1],t[2]);r.multiplyScalar(n.radius),f[c]=new s(n.center.clone().add(r),.5*n.radius)}for(var c=0;8>c;c++){if(0==m[c])continue;let e=this.generateLocCode(r,c);this.build(p[c],t,f[c],e)}return this}getLocCodes(){return Object.keys(this.aabbs)}getDepth(e){return m.msb(e)/3}generateLocCode(e,t){let o=m.msb(e);return-1==o?8|t:(e=e<<=3,e|t)}traverse(e,t=1){for(var o=0;8>o;o++){let n=t<<3|o;this.aabbs[n]&&(e(this.points[n],this.aabbs[n],n),this.traverse(e,n))}}traverseIf(e,t,o=1){for(var n=0;8>n;n++){let r=o<<3|n;if(this.aabbs[r]){if(!t(this.aabbs[r],r))continue;e(this.points[r],this.aabbs[r],r),this.traverseIf(e,t,r)}}}raySearch(e){let t=[];if(this.points[1])for(var o=0;o<this.points[1].length;o++)t.push({index:this.points[1][o],locCode:1});let n=e.ray.direction.clone();n.normalize();let r=new a(1,1,1);return r.divide(n),this.traverseIf(function(e,o,n){if(e)for(var r=0;r<e.length;r++)t.push({index:e[r],locCode:n})},function(t){return t.cylinderTest(e.ray.source,r,e.far,e.threshold)}),t}intersectBox(e,t){return console.log(this.aabbs),this.traverseIf(function(e,t,o){e&&console.log(o,e.length)},function(o){return!(e.getX()<o.max[0]&&t.getX()>o.min[0]&&e.getY()<o.max[1]&&t.getY()>o.min[1]&&e.getZ()<o.max[2]&&t.getZ()>o.min[2])}),[]}getCenters(e){e=e||0;let t=[];return this.traverse(function(o,n){o&&o.length>e&&t.push(n.center)}),t}getClosestBox(e,t,o=1){let r=-1,s=n;for(var a=0;8>a;a++){let n=o<<3|a;if(this.aabbs[n]){if(this.points[n]&&this.points[n].length<t)continue;let o=this.aabbs[n].distanceToPointSq(e.components[0],e.components[1],e.components[2]);o<s&&(s=o,r=n)}}return 0>r?this.aabbs[o]:this.getClosestBox(e,t,r)}getClosestBoxFromCenter(e,t,o=1){let r=-1,s=n;for(var a=0;8>a;a++){let n=o<<3|a;if(this.aabbs[n]){if(this.points[n]&&this.points[n].length<t)continue;let o=this.aabbs[n].distanceFromCenterToPointSq(e.components[0],e.components[1],e.components[2]);o<s&&(s=o,r=n)}}return 0>r?this.aabbs[o]:this.getClosestBox(e,t,r)}getFarthestBox(e,t,n){let r=-1,s=o;for(var a=0;8>a;a++){let o=n<<3|a;if(this.aabbs[o]){if(this.points[o]&&this.points[o].length<t)continue;let n=this.aabbs[o].distanceToPointSq(e.components[0],e.components[1],e.components[2]);n>s&&(s=n,r=o)}}return 0>r?this.aabbs[n]:this.getFarthestBox(e,t,r)}getClosestPoint(e,t,o,s){o=o||0;let l=n,c=null,m=null;m=s?this.aabbs[s]:this.getClosestBox(e,o);let d=this.points[m.getLocCode()];if(!d)return null;for(var p=0;p<d.length;p++){let o=d[p];o*=3;let n=t[o],i=t[o+1],s=t[o+2],a=e.components,m=r(a[0]-n,2)+r(a[1]-i,2)+r(a[2]-s,2);m<l&&(l=m,c={x:n,y:i,z:s})}return c?new a(c.x,c.y,c.z):null}getFarthestPoint(e,t,n,s){n=n||0;let l=o,c=null,m=null;m=s?this.aabbs[s]:this.getFarthestBox(e,n);let d=this.points[m.getLocCode()];if(!d)return null;for(var p=0;p<d.length;p++){let o=d[p];o*=3;let n=t[o],i=t[o+1],s=t[o+2],a=e.components,m=r(a[0]-n,2)+r(a[1]-i,2)+r(a[2]-s,2);m>l&&(l=m,c={x:n,y:i,z:s})}return c?new a(c.x,c.y,c.z):null}getParent(e){return e>>>3}getNeighbours(e){let t=this,o=[];return this.traverseIf(function(t,n,r){t&&0<t.length&&r!=e&&o.push(r)},function(o){return o.testAABB(t.aabbs[e])}),o}kNearestNeighbours(e,t,o,n){e+=1;let r=n.length/3,s=t;if(!isNaN(parseFloat(t))){let e={x:n[3*e],y:n[3*e+1],z:n[3*e+2]}}null===o&&(o=this.getClosestBoxFromCenter(new a(s.x,s.y,s.z),0).locCode);let l=this.getCellDistancesToPoint(s.x,s.y,s.z,o),c=this.pointDistancesSq(s.x,s.y,s.z,o,n),m=new f,d=m.sort(c.distancesSq,!0),p=m.sort(l.distancesSq,!0),g=0,h=0,x=new Uint32Array(e);for(var v=0;h<e&&v<d.array.length;v++){if(d.array[v]>p.array[0]){g=v;break}x[v]=c.indices[d.indices[v]],h++}if(h==e)return x;for(var v=0;v<p.array.length;v++){let t=l.locCodes[p.indices[v]],o=this.pointDistancesSq(s.x,s.y,s.z,t,n);c=u.mergePointDistances(c,o);let i=m.sort(c.distancesSq,!0);for(var y=g;h<e&&y<i.array.length;y++){if(i.array[y]>p.array[v+1]){g=y;break}x[y]=c.indices[i.indices[y]],h++}if(h==e||h>=r-1)return x}return x}getCellDistancesToPoint(e,t,o,n){let r=[];this.traverse(function(e,t,o){e&&0<e.length&&o!=n&&r.push(o)});let s=new Float32Array(r.length);for(var a=0;a<r.length;a++)s[a]=this.aabbs[r[a]].distanceToPointSq(e,t,o);return{locCodes:r,distancesSq:s}}expandNeighbourhood(e,t,o,n,r){let s=r.locCodes,a=r.distancesSq,l=s.length;for(var d=l-1;0<=d;d--){let e=this.getNeighbours(s[d]);for(var p=0;p<e.length;p++)e[p]===n||m.arrayContains(s,e[p])||s.push(e[p])}let f=s.length,u=a.length;if(f!==u){let n=new Float32Array(f-u);for(var d=u,g=0;d<f;d++,g++)n[g]=this.aabbs[s[d]].distanceToPointSq(e,t,o);return r.distancesSq=m.concatTypedArrays(a,n),s.length-l}}cellDistancesSq(e,t,o,n){let r=this.getNeighbours(n),s=new Float32Array(r.length);for(var a=0;a<r.length;a++)s[a]=this.aabbs[r[a]].distanceToPointSq(e,t,o);return{locCodes:r,distancesSq:s}}pointDistancesSq(e,t,o,n,s){let a=this.points[n],l=new Uint32Array(a.length),c=new Float32Array(a.length);for(var m=0;m<a.length;m++){let n=3*a[m],i=s[n],d=s[n+1],p=s[n+2];l[m]=a[m],c[m]=r(i-e,2)+r(d-t,2)+r(p-o,2)}return{indices:l,distancesSq:c}}static concatTypedArrays(e,t){let o=new e.constructor(e.length+t.length);return o.set(e),o.set(t,e.length),o}static mergePointDistances(e,t){let o={indices:u.concatTypedArrays(e.indices,t.indices),distancesSq:u.concatTypedArrays(e.distancesSq,t.distancesSq)};return o}static mergeCellDistances(e,t){let o={locCodes:u.concatTypedArrays(e.locCodes,t.locCodes),distancesSq:u.concatTypedArrays(e.distancesSq,t.distancesSq)};return o}static clone(e){let t=new u;for(var o in t.threshold=e.threshold,t.maxDepth=e.maxDepth,t.points=e.points,e.aabbs)e.aabbs.hasOwnProperty(o)&&(t.aabbs[o]=s.clone(e.aabbs[o]));return t}}t.exports=u},{"../Math/ProjectionMatrix":39,"../Math/RadixSort":41,"../Math/Vector3f":45,"../Utils/Utils":62,"./AABB":58,"./Raycaster":60}],60:[function(e,t){"use strict";const o=e("../Math/Ray"),n=e("../Math/Matrix4f");t.exports=class{constructor(e=.1){this.ray=new o,this.near=0,this.far=1e3,this.threshold=e}set(e,t,o){return this.near=e.near,this.far=e.far,this.ray.source.set(t,o,(e.near+e.far)/(e.near-e.far)),n.unprojectVector(this.ray.source,e),this.ray.direction.set(0,0,-1),this.ray.direction.toDirection(e.modelMatrix),this}}},{"../Math/Matrix4f":38,"../Math/Ray":42}],61:[function(e,t){"use strict";const o=e("./AABB"),n=e("./Octree"),r=e("./Raycaster");t.exports={AABB:o,Octree:n,Raycaster:r}},{"./AABB":58,"./Octree":59,"./Raycaster":60}],62:[function(e,t){"use strict";class o{static extend(){let e={},t=!1,n=0,r=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],n++);for(let i=function(n){for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=t&&"[object Object]"===Object.prototype.toString.call(n[r])?o.extend(!0,e[r],n[r]):n[r])};n<r;n++){let e=arguments[n];i(e)}return e}static arrayContains(e,t){for(let o=0;o<e.length;o++)if(e[o]===t)return!0;return!1}static concatTypedArrays(e,t){let o=new e.constructor(e.length+t.length);return o.set(e),o.set(t,e.length),o}static msb(e){return 2147483648&e?31:o.msb(1|e<<1)-1}static mergePointDistances(e,t){let n={indices:o.concatTypedArrays(e.indices,t.indices),distancesSq:o.concatTypedArrays(e.distancesSq,t.distancesSq)};return n}static isInt(e){return+e===e&&0==e%1}static isFloat(e){return+e===e&&0!=e%1}static jsonp(e,t){let o="jsonp_callback_"+Math.round(1e5*Math.random());window[o]=function(e){delete window[o],document.body.removeChild(n),t(e)};let n=document.createElement("script");n.src=e+(0<=e.indexOf("?")?"&":"?")+"callback="+o,document.body.appendChild(n)}}o.DEG2RAD=Math.PI/180,t.exports=o},{}],63:[function(e,t){"use strict";const o=e("./Utils");t.exports={Utils:o}},{"./Utils":62}]},{},[1]);
//# sourceMappingURL=lore.min.js.map
